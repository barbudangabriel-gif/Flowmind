=== ENV ===
v20.19.4
10.8.2
Python 3.11.13
pip 24.0 from /root/.venv/lib/python3.11/site-packages/pip (python 3.11)

=== GIT HYGIENE ===
?? production_audit_final.txt
f963c3d release: production-ready security hardening & observability
bd73f04 Auto-commit before changes
5105de0 auto-commit for c8f4fa40-82f9-4ecc-bc92-4494a19cafe8
f210492 auto-commit for 4fc4b449-5461-4cdf-b9fb-482bc064b8cc
7f6fde4 feat(security): complete security audit remediation

TODO in main (NU e voie):
.pre-commit-config.yaml:5:        name: Block TODO without ticket
.pre-commit-config.yaml:6:        entry: bash -c '! git grep -n -P "TODO(?!\\[)" -- . | tee /dev/stderr'
README_RELEASE.md:37:- Pre-commit blocks TODO fÄƒrÄƒ ticket, commit Ã®n `main`, È™i patterns de secrete.
STOCK_ANALYSIS_ROADMAP.md:1:# ðŸ“Š STOCK ANALYSIS COMPLETÄ‚ - TODO ROADMAP
audit_out/audit_20250824_204956/quality.txt:2:TODO/FIXME comments: 9
audit_out/audit_20250824_204956/report.json:48:      "description": "TODO comments indicate pending features and improvements",
audit_out/audit_20250824_204956/summary.txt:19:- TODO Items: 9
audit_report.txt:291:TODO in main (NU e voie):
audit_report.txt:292:STOCK_ANALYSIS_ROADMAP.md:1:# ðŸ“Š STOCK ANALYSIS COMPLETÄ‚ - TODO ROADMAP
audit_report.txt:293:audit_out/audit_20250824_204956/quality.txt:2:TODO/FIXME comments: 9
audit_report.txt:294:audit_out/audit_20250824_204956/report.json:48:      "description": "TODO comments indicate pending features and improvements",
audit_report.txt:295:audit_out/audit_20250824_204956/summary.txt:19:- TODO Items: 9
audit_report.txt:296:backend/investment_scoring.py:49:            # TODO: Integrare TradeStation API pentru lista completÄƒ de tickere
audit_report.txt:297:backend/mindfolios.py:491:            "pnl_unrealized": 0,  # TODO: requires market prices
audit_report.txt:298:backend/mindfolios.py:494:            "win_rate": None,  # TODO: calculate from profitable vs losing trades
audit_report.txt:299:backend/mindfolios.py:495:            "expectancy": None,  # TODO: average profit per trade
audit_report.txt:300:backend/mindfolios.py:496:            "max_dd": None,  # TODO: calculate from equity curve
audit_report.txt:301:backend/mindfolios.py:698:        # TODO: Implement actual quote subscription when database service is available
audit_report.txt:302:backend/mindfolios.py:733:        # TODO: Implement actual database integration when available
audit_report.txt:303:backend/mindfolios.py:777:        # Create mock bucket (TODO: Implement actual database integration)
audit_report.txt:304:backend/mindfolios.py:850:                "win_rate": None,  # TODO: Calculate from profitable trades
audit_report.txt:305:backend/mindfolios.py:851:                "sharpe_ratio": None,  # TODO: Calculate from equity curve
audit_report.txt:306:backend/mindfolios.py:852:                "max_drawdown": None,  # TODO: Calculate from equity curve
audit_report.txt:307:backend/mindfolios.py:855:            "buckets": [],  # TODO: Implement bucket-level analytics
audit_report.txt:308:scripts/audit.sh:97:    # TODO/FIXME comments
audit_report.txt:309:scripts/audit.sh:98:    TODO_COUNT=$(grep -r "TODO\|FIXME\|HACK\|XXX" /app --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=audit_out 2>/dev/null | wc -l || echo "0")
audit_report.txt:310:scripts/audit.sh:99:    echo "TODO/FIXME comments: $TODO_COUNT" >> "$AUDIT_DIR/quality.txt"
audit_report.txt:311:scripts/audit.sh:153:    TODO_COUNT=$(grep "TODO/FIXME" "$AUDIT_DIR/quality.txt" | awk '{print $3}')
audit_report.txt:312:scripts/audit.sh:174:- TODO Items: ${TODO_COUNT:-0}
audit_report.txt:313:tools/audit.sh:9:echo; echo "TODO in main (NU e voie):"
audit_report.txt:314:tools/audit.sh:10:git grep -nE 'TODO|FIXME' -- ':!**/node_modules/**' ':!**/dist/**' ':!**/build/**' || true
backend/investment_scoring.py:145:            # TODO[OPS-008]: Integrare TradeStation API pentru lista completÄƒ de tickere
backend/mindfolios.py:699:        # TODO[OPS-001]: Implement actual quote subscription when database service is available
backend/mindfolios.py:734:        # TODO[OPS-002]: Implement actual database integration when available
backend/mindfolios.py:778:        # Create mock bucket (TODO[OPS-003]: Implement actual database integration)
backend/mindfolios.py:851:                "win_rate": None,  # TODO[OPS-004]: Calculate from profitable trades
backend/mindfolios.py:852:                "sharpe_ratio": None,  # TODO[OPS-005]: Calculate from equity curve
backend/mindfolios.py:853:                "max_drawdown": None,  # TODO[OPS-006]: Calculate from equity curve
backend/mindfolios.py:856:            "buckets": [],  # TODO[OPS-007]: Implement bucket-level analytics
final_audit_report.txt:24:TODO in main (NU e voie):
final_audit_report.txt:25:.pre-commit-config.yaml:5:        name: Block TODO without ticket
final_audit_report.txt:26:.pre-commit-config.yaml:6:        entry: bash -c '! git grep -n -P "TODO(?!\\[)" -- . | tee /dev/stderr'
final_audit_report.txt:27:STOCK_ANALYSIS_ROADMAP.md:1:# ðŸ“Š STOCK ANALYSIS COMPLETÄ‚ - TODO ROADMAP
final_audit_report.txt:28:audit_out/audit_20250824_204956/quality.txt:2:TODO/FIXME comments: 9
final_audit_report.txt:29:audit_out/audit_20250824_204956/report.json:48:      "description": "TODO comments indicate pending features and improvements",
final_audit_report.txt:30:audit_out/audit_20250824_204956/summary.txt:19:- TODO Items: 9
final_audit_report.txt:31:audit_report.txt:291:TODO in main (NU e voie):
final_audit_report.txt:32:audit_report.txt:292:STOCK_ANALYSIS_ROADMAP.md:1:# ðŸ“Š STOCK ANALYSIS COMPLETÄ‚ - TODO ROADMAP
final_audit_report.txt:33:audit_report.txt:293:audit_out/audit_20250824_204956/quality.txt:2:TODO/FIXME comments: 9
final_audit_report.txt:34:audit_report.txt:294:audit_out/audit_20250824_204956/report.json:48:      "description": "TODO comments indicate pending features and improvements",
final_audit_report.txt:35:audit_report.txt:295:audit_out/audit_20250824_204956/summary.txt:19:- TODO Items: 9
final_audit_report.txt:36:audit_report.txt:296:backend/investment_scoring.py:49:            # TODO: Integrare TradeStation API pentru lista completÄƒ de tickere
final_audit_report.txt:37:audit_report.txt:297:backend/mindfolios.py:491:            "pnl_unrealized": 0,  # TODO: requires market prices
final_audit_report.txt:38:audit_report.txt:298:backend/mindfolios.py:494:            "win_rate": None,  # TODO: calculate from profitable vs losing trades
final_audit_report.txt:39:audit_report.txt:299:backend/mindfolios.py:495:            "expectancy": None,  # TODO: average profit per trade
final_audit_report.txt:40:audit_report.txt:300:backend/mindfolios.py:496:            "max_dd": None,  # TODO: calculate from equity curve
final_audit_report.txt:41:audit_report.txt:301:backend/mindfolios.py:698:        # TODO: Implement actual quote subscription when database service is available
final_audit_report.txt:42:audit_report.txt:302:backend/mindfolios.py:733:        # TODO: Implement actual database integration when available
final_audit_report.txt:43:audit_report.txt:303:backend/mindfolios.py:777:        # Create mock bucket (TODO: Implement actual database integration)
final_audit_report.txt:44:audit_report.txt:304:backend/mindfolios.py:850:                "win_rate": None,  # TODO: Calculate from profitable trades
final_audit_report.txt:45:audit_report.txt:305:backend/mindfolios.py:851:                "sharpe_ratio": None,  # TODO: Calculate from equity curve
final_audit_report.txt:46:audit_report.txt:306:backend/mindfolios.py:852:                "max_drawdown": None,  # TODO: Calculate from equity curve
final_audit_report.txt:47:audit_report.txt:307:backend/mindfolios.py:855:            "buckets": [],  # TODO: Implement bucket-level analytics
final_audit_report.txt:48:audit_report.txt:308:scripts/audit.sh:97:    # TODO/FIXME comments
final_audit_report.txt:49:audit_report.txt:309:scripts/audit.sh:98:    TODO_COUNT=$(grep -r "TODO\|FIXME\|HACK\|XXX" /app --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=audit_out 2>/dev/null | wc -l || echo "0")
final_audit_report.txt:50:audit_report.txt:310:scripts/audit.sh:99:    echo "TODO/FIXME comments: $TODO_COUNT" >> "$AUDIT_DIR/quality.txt"
final_audit_report.txt:51:audit_report.txt:311:scripts/audit.sh:153:    TODO_COUNT=$(grep "TODO/FIXME" "$AUDIT_DIR/quality.txt" | awk '{print $3}')
final_audit_report.txt:52:audit_report.txt:312:scripts/audit.sh:174:- TODO Items: ${TODO_COUNT:-0}
final_audit_report.txt:53:audit_report.txt:313:tools/audit.sh:9:echo; echo "TODO in main (NU e voie):"
final_audit_report.txt:54:audit_report.txt:314:tools/audit.sh:10:git grep -nE 'TODO|FIXME' -- ':!**/node_modules/**' ':!**/dist/**' ':!**/build/**' || true
final_audit_report.txt:55:backend/investment_scoring.py:145:            # TODO[OPS-008]: Integrare TradeStation API pentru lista completÄƒ de tickere
final_audit_report.txt:56:backend/observability.py:129:        # TODO[OPS-009]: Add database connectivity check
final_audit_report.txt:57:backend/observability.py:130:        # TODO[OPS-010]: Add external API health checks
final_audit_report.txt:58:backend/mindfolios.py:699:        # TODO[OPS-001]: Implement actual quote subscription when database service is available
final_audit_report.txt:59:backend/mindfolios.py:734:        # TODO[OPS-002]: Implement actual database integration when available
final_audit_report.txt:60:backend/mindfolios.py:778:        # Create mock bucket (TODO[OPS-003]: Implement actual database integration)
final_audit_report.txt:61:backend/mindfolios.py:851:                "win_rate": None,  # TODO[OPS-004]: Calculate from profitable trades
final_audit_report.txt:62:backend/mindfolios.py:852:                "sharpe_ratio": None,  # TODO[OPS-005]: Calculate from equity curve
final_audit_report.txt:63:backend/mindfolios.py:853:                "max_drawdown": None,  # TODO[OPS-006]: Calculate from equity curve
final_audit_report.txt:64:backend/mindfolios.py:856:            "buckets": [],  # TODO[OPS-007]: Implement bucket-level analytics
final_audit_report.txt:65:scripts/audit.sh:97:    # TODO/FIXME comments
final_audit_report.txt:66:scripts/audit.sh:98:    TODO_COUNT=$(grep -r "TODO\|FIXME\|HACK\|XXX" /app --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=audit_out 2>/dev/null | wc -l || echo "0")
final_audit_report.txt:67:scripts/audit.sh:99:    echo "TODO/FIXME comments: $TODO_COUNT" >> "$AUDIT_DIR/quality.txt"
final_audit_report.txt:68:scripts/audit.sh:153:    TODO_COUNT=$(grep "TODO/FIXME" "$AUDIT_DIR/quality.txt" | awk '{print $3}')
final_audit_report.txt:69:scripts/audit.sh:174:- TODO Items: ${TODO_COUNT:-0}
final_audit_report.txt:70:tools/audit.sh:9:echo; echo "TODO in main (NU e voie):"
final_audit_report.txt:71:tools/audit.sh:10:git grep -nE 'TODO|FIXME' -- ':!**/node_modules/**' ':!**/dist/**' ':!**/build/**' || true
scripts/audit.sh:97:    # TODO/FIXME comments
scripts/audit.sh:98:    TODO_COUNT=$(grep -r "TODO\|FIXME\|HACK\|XXX" /app --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=audit_out 2>/dev/null | wc -l || echo "0")
scripts/audit.sh:99:    echo "TODO/FIXME comments: $TODO_COUNT" >> "$AUDIT_DIR/quality.txt"
scripts/audit.sh:153:    TODO_COUNT=$(grep "TODO/FIXME" "$AUDIT_DIR/quality.txt" | awk '{print $3}')
scripts/audit.sh:174:- TODO Items: ${TODO_COUNT:-0}
tools/audit.sh:9:echo; echo "TODO in main (NU e voie):"
tools/audit.sh:10:git grep -nE 'TODO|FIXME' -- ':!**/node_modules/**' ':!**/dist/**' ':!**/build/**' || true

=== FRONTEND ===

=== BACKEND (Python) ===
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
weasel 0.3.4 requires typer<0.10.0,>=0.3.0, but you have typer 0.17.3 which is incompatible.
spacy 3.7.2 requires typer<0.10.0,>=0.3.0, but you have typer 0.17.3 which is incompatible.

[bandit] Security scan (src/app, app, backend*)
Run started:2025-09-02 23:59:13.171771

Test results:
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:287:14
286	        # SimuleazÄƒ indicatori realisti
287	        rsi = random.uniform(30, 80)  
288	        trend_strength = random.uniform(40, 90)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:288:25
287	        rsi = random.uniform(30, 80)  
288	        trend_strength = random.uniform(40, 90)
289	        volume_ratio = random.uniform(0.8, 2.5)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:289:23
288	        trend_strength = random.uniform(40, 90)
289	        volume_ratio = random.uniform(0.8, 2.5)
290	        bollinger_position = random.uniform(20, 80)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:290:29
289	        volume_ratio = random.uniform(0.8, 2.5)
290	        bollinger_position = random.uniform(20, 80)
291	        

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:297:24
296	                'rsi': rsi,
297	                'macd': random.uniform(-2, 2),
298	                'volume_ratio': volume_ratio,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:300:31
299	                'bollinger_position': bollinger_position,
300	                'atr_percent': random.uniform(1, 4),
301	                'distance_to_resistance': random.uniform(2, 15),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:301:42
300	                'atr_percent': random.uniform(1, 4),
301	                'distance_to_resistance': random.uniform(2, 15),
302	                'distance_to_support': random.uniform(2, 15)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:302:39
301	                'distance_to_resistance': random.uniform(2, 15),
302	                'distance_to_support': random.uniform(2, 15)
303	            },

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:317:24
316	        return {
317	            'pe_ratio': random.uniform(10, 30),
318	            'pb_ratio': random.uniform(1, 5),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:318:24
317	            'pe_ratio': random.uniform(10, 30),
318	            'pb_ratio': random.uniform(1, 5),
319	            'roe': random.uniform(5, 25),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:319:19
318	            'pb_ratio': random.uniform(1, 5),
319	            'roe': random.uniform(5, 25),
320	            'debt_to_equity': random.uniform(0.2, 2.0),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:320:30
319	            'roe': random.uniform(5, 25),
320	            'debt_to_equity': random.uniform(0.2, 2.0),
321	            'current_ratio': random.uniform(1.0, 3.0),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:321:29
320	            'debt_to_equity': random.uniform(0.2, 2.0),
321	            'current_ratio': random.uniform(1.0, 3.0),
322	            'revenue_growth': random.uniform(-10, 20),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:322:30
321	            'current_ratio': random.uniform(1.0, 3.0),
322	            'revenue_growth': random.uniform(-10, 20),
323	            'earnings_growth': random.uniform(-15, 25),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:323:31
322	            'revenue_growth': random.uniform(-10, 20),
323	            'earnings_growth': random.uniform(-15, 25),
324	            'gross_margin': random.uniform(20, 60),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:324:28
323	            'earnings_growth': random.uniform(-15, 25),
324	            'gross_margin': random.uniform(20, 60),
325	            'net_margin': random.uniform(5, 25),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:325:26
324	            'gross_margin': random.uniform(20, 60),
325	            'net_margin': random.uniform(5, 25),
326	            'dividend_yield': random.uniform(0, 5),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:326:30
325	            'net_margin': random.uniform(5, 25),
326	            'dividend_yield': random.uniform(0, 5),
327	            'is_mock': True

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:344:30
343	        return {
344	            'put_call_ratio': random.uniform(0.5, 2.0),
345	            'unusual_volume_score': random.uniform(0, 100),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:345:36
344	            'put_call_ratio': random.uniform(0.5, 2.0),
345	            'unusual_volume_score': random.uniform(0, 100),
346	            'large_trades_count': random.randint(0, 50),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:346:34
345	            'unusual_volume_score': random.uniform(0, 100),
346	            'large_trades_count': random.randint(0, 50),
347	            'options_sentiment': random.choice(['bullish', 'neutral', 'bearish']),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:347:33
346	            'large_trades_count': random.randint(0, 50),
347	            'options_sentiment': random.choice(['bullish', 'neutral', 'bearish']),
348	            'is_mock': True

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:356:30
355	        return {
356	            'news_sentiment': random.uniform(-1, 1),  # -1 bearish, +1 bullish
357	            'social_sentiment': random.uniform(-1, 1),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:357:32
356	            'news_sentiment': random.uniform(-1, 1),  # -1 bearish, +1 bullish
357	            'social_sentiment': random.uniform(-1, 1),
358	            'analyst_rating': random.uniform(1, 5),   # 1=strong sell, 5=strong buy

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:358:30
357	            'social_sentiment': random.uniform(-1, 1),
358	            'analyst_rating': random.uniform(1, 5),   # 1=strong sell, 5=strong buy
359	            'price_target_change': random.uniform(-10, 10),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:359:35
358	            'analyst_rating': random.uniform(1, 5),   # 1=strong sell, 5=strong buy
359	            'price_target_change': random.uniform(-10, 10),
360	            'is_mock': True

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:368:20
367	        return {
368	            'beta': random.uniform(0.5, 2.0),
369	            'max_drawdown': random.uniform(5, 30),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:369:28
368	            'beta': random.uniform(0.5, 2.0),
369	            'max_drawdown': random.uniform(5, 30),
370	            'volatility': random.uniform(15, 60),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:370:26
369	            'max_drawdown': random.uniform(5, 30),
370	            'volatility': random.uniform(15, 60),
371	            'sharpe_ratio': random.uniform(0.5, 2.5),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:371:28
370	            'volatility': random.uniform(15, 60),
371	            'sharpe_ratio': random.uniform(0.5, 2.5),
372	            'is_mock': True

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:658:25
657	            import random
658	            mock_price = random.uniform(50, 500)
659	            return {

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:662:32
661	                'price': round(mock_price, 2),
662	                'change': round(random.uniform(-10, 10), 2),
663	                'change_percent': round(random.uniform(-5, 5), 2),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:663:40
662	                'change': round(random.uniform(-10, 10), 2),
663	                'change_percent': round(random.uniform(-5, 5), 2),
664	                'volume': random.randint(1000000, 50000000),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/advanced_scoring_engine.py:664:26
663	                'change_percent': round(random.uniform(-5, 5), 2),
664	                'volume': random.randint(1000000, 50000000),
665	                'timestamp': datetime.utcnow().isoformat(),

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/app/services/tradestation.py:221:12
220	                mongo_ok = True
221	            except Exception:
222	                pass
223	        

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/bt_cache_integration.py:178:4
177	        db = p.path or "/0"
178	    except:
179	        pass
180	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/bt_emergent.py:42:4
41	        db = p.path or "/0"
42	    except:
43	        pass
44	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: backend/bt_emergent.py:82:12
81	                        verified += 1
82	            except Exception:
83	                continue
84	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/bt_emergent.py:85:4
84	
85	    except Exception:
86	        pass
87	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/iv_service/provider_stub.py:8:28
7	        base = 180.0 if symbol.upper() == "NVDA" else 100.0
8	        return round(base + random.uniform(-2, 2), 2)
9	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/iv_service/provider_stub.py:11:20
10	    async def get_atm_iv(self, symbol: str, dte: int) -> float:
11	        iv = 0.25 + random.uniform(-0.01, 0.01)
12	        return max(0.05, min(iv, 1.0))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/market_sentiment_analyzer.py:341:12
340	                    )
341	            except:
342	                pass  # Insider data not available
343	            

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/middleware/rate_limit.py:49:4
48	            return JSONResponse({"detail": "Rate limit exceeded"}, status_code=429)
49	    except Exception:
50	        # fail-open dacÄƒ Redis nu rÄƒspunde
51	        pass
52	    return await call_next(request)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/options_selling_service.py:289:4
288	        await _db["options_monitor_snapshots"].insert_one(doc)
289	    except Exception:
290	        # Best effort logging; do not break monitor
291	        pass
292	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/options_selling_service.py:335:8
334	    async def _loop(self):
335	        assert self._req is not None
336	        interval = max(5, int(self._req.interval_seconds or 15))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/options_selling_service.py:429:12
428	                pass
429	            except Exception:
430	                pass
431	        self._task = None

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/mindfolio_charts_service.py:139:27
138	            # Add some realistic volatility and trends
139	            stocks_noise = random.uniform(-50, 50)
140	            options_noise = random.uniform(-30, 30)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/mindfolio_charts_service.py:140:28
139	            stocks_noise = random.uniform(-50, 50)
140	            options_noise = random.uniform(-30, 30)
141	            

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/mindfolio_charts_service.py:143:28
142	            # Slight upward trend with volatility
143	            stocks_trend += random.uniform(-5, 10)
144	            options_trend += random.uniform(-8, 12)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/mindfolio_charts_service.py:144:29
143	            stocks_trend += random.uniform(-5, 10)
144	            options_trend += random.uniform(-8, 12)
145	            

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/mindfolio_charts_service.py:208:71
207	            # Simulate some positions being closed
208	            filtered_positions = [pos for pos in filtered_positions if random.random() > 0.3]
209	        

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/mindfolio_charts_service.py:212:23
211	        for pos in filtered_positions:
212	            variance = random.uniform(0.9, 1.1)
213	            pos['value'] = round(pos['value'] * variance, 2)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/mindfolios.py:1025:8
1024	            kv.set(snapshot_key, json.dumps(snapshot.dict()), ex=86400 * 90)  # 90 days
1025	        except Exception:
1026	            pass  # Redis cache is optional
1027	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/mindfolios.py:1057:8
1056	            kv.set(series_key, json.dumps(series), ex=86400 * 90)
1057	        except Exception:
1058	            pass  # Redis cache is optional
1059	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/mindfolios.py:1083:8
1082	                series = json.loads(existing_series)
1083	        except Exception:
1084	            pass  # Redis cache is optional
1085	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/routers/options.py:95:70
94	            oi = int(800 + (1 - min(moneyness, 1)) * 4500)  # OI mai mare aproape de ATM
95	            vol = int(50 + 600 * max(0, 1 - moneyness) * (0.6 + 0.4 * random.random()))
96	            total_oi += oi

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: backend/routers/options_overview.py:40:8
39	            dt = datetime.fromisoformat(dt_str.replace("Z", "+00:00"))
40	        except Exception:
41	            continue
42	        d = abs((dt - target).total_seconds())

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/server.py:512:22
511	        now = int(time.time())
512	        price = 150 + random.random() * 50
513	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/server.py:517:22
516	            timestamp = now - (i * seconds)
517	            change = (random.random() - 0.5) * 4
518	            open_price = price

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/server.py:520:56
519	            close_price = price + change
520	            high_price = max(open_price, close_price) + random.random() * 2
521	            low_price = min(open_price, close_price) - random.random() * 2

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/server.py:521:55
520	            high_price = max(open_price, close_price) + random.random() * 2
521	            low_price = min(open_price, close_price) - random.random() * 2
522	            volume = random.randint(100000, 2000000)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/server.py:522:21
521	            low_price = min(open_price, close_price) - random.random() * 2
522	            volume = random.randint(100000, 2000000)
523	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: backend/server_backup.py:325:12
324	                overview_data.append(data)
325	            except:
326	                continue
327	        

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: backend/server_backup.py:343:8
342	            movers.append(data)
343	        except:
344	            continue
345	    

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/services/builder_engine.py:109:8
108	                iv_atm = best
109	        except Exception:
110	            pass
111	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: backend/services/historical_engine.py:67:12
66	                )
67	            except:
68	                continue
69	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: backend/services/providers/ts_provider.py:29:12
28	                        return float(row["last"])
29	            except Exception:
30	                pass  # Fallback to TS API
31	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: backend/services/providers/uw_provider.py:143:16
142	                    exp_date = f"{year:04d}-{month:02d}-{day:02d}"
143	                except:
144	                    continue
145	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: backend/services/providers/uw_provider.py:149:16
148	                    strike = float(strike_str) / 1000.0
149	                except:
150	                    continue
151	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b112_try_except_continue.html
   Location: backend/services/providers/uw_provider.py:164:20
163	                            continue
164	                    except:
165	                        continue
166	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:54:23
53	        items = []
54	        for _ in range(random.randint(20, 50)):
55	            ticker = random.choice(tickers)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:55:21
54	        for _ in range(random.randint(20, 50)):
55	            ticker = random.choice(tickers)
56	            side = random.choice(sides)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:56:19
55	            ticker = random.choice(tickers)
56	            side = random.choice(sides)
57	            kind = random.choice(kinds)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:57:19
56	            side = random.choice(sides)
57	            kind = random.choice(kinds)
58	            opt_type = random.choice(types)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:58:23
57	            kind = random.choice(kinds)
58	            opt_type = random.choice(types)
59	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:62:55
61	                "time": (
62	                    datetime.now() - timedelta(minutes=random.randint(0, 60))
63	                ).isoformat(),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:66:33
65	                "side": side,
66	                "premium": round(random.uniform(1000, 100000), 2),
67	                "price": round(random.uniform(0.5, 50), 2),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:67:31
66	                "premium": round(random.uniform(1000, 100000), 2),
67	                "price": round(random.uniform(0.5, 50), 2),
68	                "size": random.randint(1, 100),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:68:24
67	                "price": round(random.uniform(0.5, 50), 2),
68	                "size": random.randint(1, 100),
69	                "kind": kind,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:71:26
70	                "type": opt_type,
71	                "strike": random.randint(100, 500),
72	                "expiry": (

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:73:52
72	                "expiry": (
73	                    datetime.now() + timedelta(days=random.randint(1, 365))
74	                ).strftime("%Y-%m-%d"),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:75:23
74	                ).strftime("%Y-%m-%d"),
75	                "dte": random.randint(1, 365),
76	                "iv": round(random.uniform(0.2, 2.0), 3),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:76:28
75	                "dte": random.randint(1, 365),
76	                "iv": round(random.uniform(0.2, 2.0), 3),
77	                "execution": random.choice(executions),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:77:29
76	                "iv": round(random.uniform(0.2, 2.0), 3),
77	                "execution": random.choice(executions),
78	                "volume": random.randint(1, 1000),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:78:26
77	                "execution": random.choice(executions),
78	                "volume": random.randint(1, 1000),
79	                "oi": random.randint(0, 5000),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:79:22
78	                "volume": random.randint(1, 1000),
79	                "oi": random.randint(0, 5000),
80	                "moneyness": round(random.uniform(0.8, 1.2), 3),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:80:35
79	                "oi": random.randint(0, 5000),
80	                "moneyness": round(random.uniform(0.8, 1.2), 3),
81	                "chance": round(random.uniform(0.1, 0.9), 3),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:81:32
80	                "moneyness": round(random.uniform(0.8, 1.2), 3),
81	                "chance": round(random.uniform(0.1, 0.9), 3),
82	            }

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:91:28
90	            {
91	                "title": f"{random.choice(tickers)} Options Activity Surges",
92	                "headline": f"Unusual {random.choice(tickers)} options volume detected",

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:92:39
91	                "title": f"{random.choice(tickers)} Options Activity Surges",
92	                "headline": f"Unusual {random.choice(tickers)} options volume detected",
93	                "source": "FlowMind",

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:95:53
94	                "time": (
95	                    datetime.now() - timedelta(hours=random.randint(0, 24))
96	                ).isoformat(),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:97:36
96	                ).isoformat(),
97	                "summary": f"Large {random.choice(kinds)} trades observed in {random.choice(types)} options",
98	            }

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:97:78
96	                ).isoformat(),
97	                "summary": f"Large {random.choice(kinds)} trades observed in {random.choice(types)} options",
98	            }

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:99:27
98	            }
99	            for _ in range(random.randint(5, 15))
100	        ]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:106:23
105	        trading_items = []
106	        for _ in range(random.randint(3, 10)):
107	            item = {

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:109:52
108	                "time": (
109	                    datetime.now() - timedelta(days=random.randint(0, 30))
110	                ).isoformat(),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:111:26
110	                ).isoformat(),
111	                "symbol": random.choice(tickers),
112	                "side": random.choice(sides),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:112:24
111	                "symbol": random.choice(tickers),
112	                "side": random.choice(sides),
113	                "premium": round(random.uniform(10000, 1000000), 2),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:113:33
112	                "side": random.choice(sides),
113	                "premium": round(random.uniform(10000, 1000000), 2),
114	                "type": random.choice(types),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:114:24
113	                "premium": round(random.uniform(10000, 1000000), 2),
114	                "type": random.choice(types),
115	                "strike": random.randint(100, 500),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:115:26
114	                "type": random.choice(types),
115	                "strike": random.randint(100, 500),
116	                "expiry": (

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:117:52
116	                "expiry": (
117	                    datetime.now() + timedelta(days=random.randint(30, 365))
118	                ).strftime("%Y-%m-%d"),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:119:23
118	                ).strftime("%Y-%m-%d"),
119	                "dte": random.randint(30, 365),
120	                "trader": f"Representative {chr(random.randint(65, 90))}"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:120:48
119	                "dte": random.randint(30, 365),
120	                "trader": f"Representative {chr(random.randint(65, 90))}"
121	                if "congress" in path

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/services/uw_flow.py:122:36
121	                if "congress" in path
122	                else f"Insider {chr(random.randint(65, 90))}",
123	            }

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:180:37
179	            market_conditions = {
180	                'overall_sentiment': random.choice(['BULLISH', 'BEARISH', 'NEUTRAL']),
181	                'vix': round(random.uniform(12, 35), 1),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:181:29
180	                'overall_sentiment': random.choice(['BULLISH', 'BEARISH', 'NEUTRAL']),
181	                'vix': round(random.uniform(12, 35), 1),
182	                'market_trend': random.choice(['UPTREND', 'DOWNTREND', 'SIDEWAYS']),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:182:32
181	                'vix': round(random.uniform(12, 35), 1),
182	                'market_trend': random.choice(['UPTREND', 'DOWNTREND', 'SIDEWAYS']),
183	                'sector_rotation': random.choice(['TECH_TO_VALUE', 'VALUE_TO_GROWTH', 'DEFENSIVE', 'CYCLICAL']),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:183:35
182	                'market_trend': random.choice(['UPTREND', 'DOWNTREND', 'SIDEWAYS']),
183	                'sector_rotation': random.choice(['TECH_TO_VALUE', 'VALUE_TO_GROWTH', 'DEFENSIVE', 'CYCLICAL']),
184	                'fed_policy': random.choice(['HAWKISH', 'DOVISH', 'NEUTRAL']),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:184:30
183	                'sector_rotation': random.choice(['TECH_TO_VALUE', 'VALUE_TO_GROWTH', 'DEFENSIVE', 'CYCLICAL']),
184	                'fed_policy': random.choice(['HAWKISH', 'DOVISH', 'NEUTRAL']),
185	                'earnings_season': random.choice(['STRONG_BEATS', 'MODERATE_BEATS', 'MIXED', 'DISAPPOINTING']),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:185:35
184	                'fed_policy': random.choice(['HAWKISH', 'DOVISH', 'NEUTRAL']),
185	                'earnings_season': random.choice(['STRONG_BEATS', 'MODERATE_BEATS', 'MIXED', 'DISAPPOINTING']),
186	                'technical_outlook': random.choice(['BULLISH', 'BEARISH', 'CONSOLIDATION']),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:186:37
185	                'earnings_season': random.choice(['STRONG_BEATS', 'MODERATE_BEATS', 'MIXED', 'DISAPPOINTING']),
186	                'technical_outlook': random.choice(['BULLISH', 'BEARISH', 'CONSOLIDATION']),
187	                'recommended_strategy': random.choice(['AGGRESSIVE_GROWTH', 'DEFENSIVE_REBALANCE', 'OPPORTUNISTIC', 'CASH_BUILDING']),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:187:40
186	                'technical_outlook': random.choice(['BULLISH', 'BEARISH', 'CONSOLIDATION']),
187	                'recommended_strategy': random.choice(['AGGRESSIVE_GROWTH', 'DEFENSIVE_REBALANCE', 'OPPORTUNISTIC', 'CASH_BUILDING']),
188	                'confidence_score': round(random.uniform(0.6, 0.95), 2),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:188:42
187	                'recommended_strategy': random.choice(['AGGRESSIVE_GROWTH', 'DEFENSIVE_REBALANCE', 'OPPORTUNISTIC', 'CASH_BUILDING']),
188	                'confidence_score': round(random.uniform(0.6, 0.95), 2),
189	                'last_updated': datetime.now().isoformat()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:233:25
232	        return {
233	            'vix': round(random.uniform(15, 25), 1),
234	            'sentiment': random.choice(['BULLISH', 'BEARISH', 'NEUTRAL']),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:234:25
233	            'vix': round(random.uniform(15, 25), 1),
234	            'sentiment': random.choice(['BULLISH', 'BEARISH', 'NEUTRAL']),
235	            'trend': random.choice(['UP', 'DOWN', 'SIDEWAYS'])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:235:21
234	            'sentiment': random.choice(['BULLISH', 'BEARISH', 'NEUTRAL']),
235	            'trend': random.choice(['UP', 'DOWN', 'SIDEWAYS'])
236	        }

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:240:21
239	        """Calculate overall mindfolio health score (1-10)"""
240	        return round(random.uniform(6.5, 9.0), 1)
241	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:244:21
243	        """Calculate diversification score"""
244	        return round(random.uniform(5.5, 8.5), 1)
245	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:248:21
247	        """Calculate risk score"""
248	        return round(random.uniform(6.0, 9.0), 1)
249	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:252:21
251	        """Calculate leverage ratio"""
252	        return round(random.uniform(1.1, 1.8), 2)
253	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:256:15
255	        """Assess concentration risk level"""
256	        return random.choice(['LOW', 'MEDIUM', 'HIGH'])
257	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:374:21
373	        """Calculate expected return from DCA opportunities"""
374	        return round(random.uniform(0.12, 0.18), 3)
375	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:378:15
377	        """Assess DCA strategy risk level"""
378	        return random.choice(['LOW', 'MODERATE', 'HIGH'])
379	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:382:21
381	        """Calculate market timing score"""
382	        return round(random.uniform(0.6, 0.85), 2)
383	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:386:15
385	        """Calculate overall mindfolio risk"""
386	        return random.choice(['LOW', 'MODERATE', 'MODERATE-HIGH', 'HIGH'])
387	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:390:21
389	        """Calculate mindfolio beta"""
390	        return round(random.uniform(1.2, 1.6), 2)
391	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:394:21
393	        """Calculate 95% Value at Risk"""
394	        return round(random.uniform(-0.05, -0.12), 3)
395	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:398:21
397	        """Calculate maximum drawdown"""
398	        return round(random.uniform(-0.10, -0.20), 3)
399	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:402:21
401	        """Calculate correlation with S&P 500"""
402	        return round(random.uniform(0.7, 0.9), 2)
403	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:406:21
405	        """Calculate mindfolio volatility"""
406	        return round(random.uniform(0.18, 0.28), 3)
407	    

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/smart_rebalancing_service.py:410:21
409	        """Calculate Sharpe ratio"""
410	        return round(random.uniform(1.0, 1.5), 2)
411	    

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:22:4
21	    r = client.get("/screen/iv-setups?strategy=DOUBLE_DIAGONAL&limit=3")
22	    assert r.status_code == 200
23	    data = r.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:24:4
23	    data = r.json()
24	    assert data["ok"]
25	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:27:8
26	    for item in data["items"]:
27	        assert item.get("signalOk") is True
28	        assert item.get("decision") in ("ALLOW", "ALLOW_WITH_WARNINGS")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:28:8
27	        assert item.get("signalOk") is True
28	        assert item.get("decision") in ("ALLOW", "ALLOW_WITH_WARNINGS")
29	        assert "backtest" in item

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:29:8
28	        assert item.get("decision") in ("ALLOW", "ALLOW_WITH_WARNINGS")
29	        assert "backtest" in item
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:36:4
35	    r1 = client.get("/screen/iv-setups?strategy=IRON_CONDOR&limit=1")
36	    assert r1.status_code == 200
37	    data1 = r1.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:41:4
40	    r2 = client.get("/screen/iv-setups?strategy=IRON_CONDOR&limit=1")
41	    assert r2.status_code == 200
42	    data2 = r2.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:49:8
48	        # Note: May be MISS/MISS Ã®n fallback mode, HIT Ã®n Redis mode
49	        assert cache2 in ("HIT", "MISS")  # Either is acceptable
50	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:56:4
55	    r = client.get("/_bt/status")
56	    assert r.status_code == 200
57	    assert r.json()["ok"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:57:4
56	    assert r.status_code == 200
57	    assert r.json()["ok"] is True
58	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:61:4
60	    r = client.get("/_bt/keys")
61	    assert r.status_code == 200
62	    assert "keys" in r.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:62:4
61	    assert r.status_code == 200
62	    assert "keys" in r.json()
63	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:74:12
73	            # Quality checks
74	            assert isinstance(bt.get("n"), int)
75	            assert bt["n"] >= 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:75:12
74	            assert isinstance(bt.get("n"), int)
75	            assert bt["n"] >= 0
76	            if bt["n"] > 30:  # Only check metrics pentru sufficient sample

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:77:16
76	            if bt["n"] > 30:  # Only check metrics pentru sufficient sample
77	                assert 0 <= bt.get("win_rate", 0) <= 1
78	                assert -10 <= bt.get("expectancy", 0) <= 10

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_backtest_cache.py:78:16
77	                assert 0 <= bt.get("win_rate", 0) <= 1
78	                assert -10 <= bt.get("expectancy", 0) <= 10

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:13:4
12	    r = client.get("/health")
13	    assert r.status_code == 200
14	    assert r.json().get("ok") is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:14:4
13	    assert r.status_code == 200
14	    assert r.json().get("ok") is True
15	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:19:4
18	    r = client.get("/api/iv/summary", params={"symbol": "NVDA"})
19	    assert r.status_code == 200
20	    j = r.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:22:8
21	    for k in ("symbol", "spot", "iv", "em_usd", "em_pct", "front_dte", "back_dte"):
22	        assert k in j
23	    assert j["symbol"] == "NVDA"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:23:4
22	        assert k in j
23	    assert j["symbol"] == "NVDA"
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:30:4
29	    )
30	    assert r.status_code == 200
31	    j = r.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:32:4
31	    j = r.json()
32	    assert "meta" in j and "rows" in j
33	    assert j["meta"]["ok"] >= 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:33:4
32	    assert "meta" in j and "rows" in j
33	    assert j["meta"]["ok"] >= 1
34	    assert any(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:34:4
33	    assert j["meta"]["ok"] >= 1
34	    assert any(
35	        "dc_low" in row and "dc_high" in row for row in j["rows"]
36	    )  # calendar fields
37	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:44:4
43	    )
44	    assert r.status_code == 200
45	    j = r.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:46:4
45	    j = r.json()
46	    assert j["meta"]["ok"] >= 1
47	    assert any(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: backend/tests/test_iv_smoke.py:47:4
46	    assert j["meta"]["ok"] >= 1
47	    assert any(
48	        "ic_shorts" in row and "ic_wings" in row for row in j["rows"]
49	    )  # condor fields

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://signin.tradestation.com/oauth/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: backend/tradestation_auth.py:29:25
28	        self.auth_url = "https://signin.tradestation.com/authorize"
29	        self.token_url = "https://signin.tradestation.com/oauth/token"
30	        

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://signin.tradestation.com/oauth/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: backend/tradestation_auth_service.py:31:25
30	        self.auth_url = "https://signin.tradestation.com/authorize"
31	        self.token_url = "https://signin.tradestation.com/oauth/token"
32	        self.api_base = "https://api.tradestation.com/v3" if self.environment == "LIVE" else "https://sim-api.tradestation.com/v3"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:505:20
504	        for i in range(80):
505	            stock = random.choice(symbols_with_details)
506	            symbol = stock["symbol"]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:512:18
511	            dte_options = [0, 1, 7, 14, 21, 30, 45, 60]
512	            dte = random.choices(dte_options, weights=dte_weights)[0]
513	            

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:515:22
514	            # Option type based on market sentiment (more bearish lately)
515	            is_call = random.choices([True, False], weights=[40, 60])[0]
516	            option_type = "call" if is_call else "put"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:530:32
529	            
530	            strike_multiplier = random.choices(strike_multipliers, weights=strike_weights)[0]
531	            strike = round(underlying_price * strike_multiplier)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:535:30
534	            if stock["activity"] == "high":
535	                base_volume = random.randint(50, 5000)
536	            elif stock["activity"] == "medium":

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:537:30
536	            elif stock["activity"] == "medium":
537	                base_volume = random.randint(20, 2000)
538	            else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:539:30
538	            else:
539	                base_volume = random.randint(5, 500)
540	                

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:543:31
542	            if dte <= 1:
543	                base_volume *= random.uniform(2, 5)
544	                

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:549:32
548	            if dte <= 1:
549	                open_interest = random.randint(1, volume)
550	            else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:551:32
550	            else:
551	                open_interest = random.randint(volume // 2, volume * 3)
552	            

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:558:31
557	                # Expiring today - very low premium
558	                base_premium = random.uniform(0.05, 2.0) * volume
559	            elif dte <= 7:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:561:31
560	                # Weekly options
561	                base_premium = random.uniform(0.5, 8.0) * volume
562	            elif dte <= 30:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:564:31
563	                # Monthly options
564	                base_premium = random.uniform(1.0, 15.0) * volume
565	            else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:567:31
566	                # LEAPS
567	                base_premium = random.uniform(5.0, 50.0) * volume
568	            

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:572:36
571	                if strike < underlying_price:  # ITM call
572	                    base_premium *= random.uniform(1.5, 3.0)
573	                elif strike > underlying_price * 1.05:  # Far OTM call

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:574:36
573	                elif strike > underlying_price * 1.05:  # Far OTM call
574	                    base_premium *= random.uniform(0.2, 0.6)
575	            else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:577:36
576	                if strike > underlying_price:  # ITM put
577	                    base_premium *= random.uniform(1.5, 3.0)
578	                elif strike < underlying_price * 0.95:  # Far OTM put

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:579:36
578	                elif strike < underlying_price * 0.95:  # Far OTM put
579	                    base_premium *= random.uniform(0.2, 0.6)
580	            

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:584:49
583	            # Buy/Sell determination based on volume/OI ratio and other factors
584	            is_opener = volume_oi_ratio > 2.0 or random.choice([True, False])
585	            action = "BUY" if is_opener else "SELL"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:987:25
986	        for i, stock in enumerate(stock_list[:limit]):
987	            base_price = random.uniform(50, 500)
988	            change = random.uniform(-10, 10)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:988:21
987	            base_price = random.uniform(50, 500)
988	            change = random.uniform(-10, 10)
989	            

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:996:26
995	                "change_percent": round((change / base_price) * 100, 2),
996	                "volume": random.randint(1000000, 50000000),
997	                "market_cap": random.randint(10000000000, 3000000000000),  # 10B to 3T

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:997:30
996	                "volume": random.randint(1000000, 50000000),
997	                "market_cap": random.randint(10000000000, 3000000000000),  # 10B to 3T
998	                "pe_ratio": round(random.uniform(10, 50), 2) if random.random() > 0.2 else None,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:998:64
997	                "market_cap": random.randint(10000000000, 3000000000000),  # 10B to 3T
998	                "pe_ratio": round(random.uniform(10, 50), 2) if random.random() > 0.2 else None,
999	                "sector": stock["sector"],

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:998:34
997	                "market_cap": random.randint(10000000000, 3000000000000),  # 10B to 3T
998	                "pe_ratio": round(random.uniform(10, 50), 2) if random.random() > 0.2 else None,
999	                "sector": stock["sector"],

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:1000:101
999	                "sector": stock["sector"],
1000	                "exchange": "NYSE" if exchange == "sp500" else "NASDAQ" if exchange == "nasdaq" else random.choice(["NYSE", "NASDAQ"]),
1001	                "dividend_yield": round(random.uniform(0, 5), 2) if random.random() > 0.4 else None,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:1001:68
1000	                "exchange": "NYSE" if exchange == "sp500" else "NASDAQ" if exchange == "nasdaq" else random.choice(["NYSE", "NASDAQ"]),
1001	                "dividend_yield": round(random.uniform(0, 5), 2) if random.random() > 0.4 else None,
1002	                "unusual_activity": random.random() > 0.8,  # 20% chance of unusual activity

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:1001:40
1000	                "exchange": "NYSE" if exchange == "sp500" else "NASDAQ" if exchange == "nasdaq" else random.choice(["NYSE", "NASDAQ"]),
1001	                "dividend_yield": round(random.uniform(0, 5), 2) if random.random() > 0.4 else None,
1002	                "unusual_activity": random.random() > 0.8,  # 20% chance of unusual activity

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:1002:36
1001	                "dividend_yield": round(random.uniform(0, 5), 2) if random.random() > 0.4 else None,
1002	                "unusual_activity": random.random() > 0.8,  # 20% chance of unusual activity
1003	                "options_flow_signal": random.choice(["bullish", "bearish", "neutral", "neutral", "neutral"])  # Mostly neutral

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: backend/unusual_whales_service.py:1003:39
1002	                "unusual_activity": random.random() > 0.8,  # 20% chance of unusual activity
1003	                "options_flow_signal": random.choice(["bullish", "bearish", "neutral", "neutral", "neutral"])  # Mostly neutral
1004	            }

--------------------------------------------------

Code scanned:
	Total lines of code: 18380
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 192
		Medium: 0
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 2
		High: 190
Files skipped (2):
	./app (No such file or directory)
	./src (No such file or directory)

[safety] Vulnerable packages


[33m[1m+===========================================================================================================================================================================================+[0m


[31m[1mDEPRECATED: [0m[33m[1mthis command (`check`) has been DEPRECATED, and will be unsupported beyond 01 June 2024.[0m


[32mWe highly encourage switching to the new [0m[32m[1m`scan`[0m[32m command which is easier to use, more powerful, and can be set up to mimic the deprecated command if required.[0m


[33m[1m+===========================================================================================================================================================================================+[0m


/root/.venv/lib/python3.11/site-packages/safety/safety.py:1857: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
+==============================================================================+

                               /$$$$$$            /$$
                              /$$__  $$          | $$
           /$$$$$$$  /$$$$$$ | $$  \__//$$$$$$  /$$$$$$   /$$   /$$
          /$$_____/ |____  $$| $$$$   /$$__  $$|_  $$_/  | $$  | $$
         |  $$$$$$   /$$$$$$$| $$_/  | $$$$$$$$  | $$    | $$  | $$
          \____  $$ /$$__  $$| $$    | $$_____/  | $$ /$$| $$  | $$
          /$$$$$$$/|  $$$$$$$| $$    |  $$$$$$$  |  $$$$/|  $$$$$$$
         |_______/  \_______/|__/     \_______/   \___/   \____  $$
                                                          /$$  | $$
                                                         |  $$$$$$/
  by safetycli.com                                        \______/

+==============================================================================+

 [1mREPORT[0m 

  Safety [1mv3.6.1[0m is scanning for [1mVulnerabilities[0m[1m...[0m
[1m  Scanning dependencies[0m in your [1menvironment:[0m

  -> /usr/local/lib/python3.11/lib-dynload
  -> /usr/local/lib/python311.zip
  -> /usr/local/lib/python3.11/site-packages
  -> /root/.venv/lib/python3.11/site-packages
  -> /root/.venv/lib/python3.11/site-packages/setuptools/_vendor
  -> /root/.venv/bin
  -> /usr/local/lib/python3.11

  Using [1mopen-source vulnerability database[0m
[1m  Found and scanned 200 packages[0m
  Timestamp [1m2025-09-02 23:59:19[0m
[1m  7[0m[1m vulnerabilities reported[0m
[1m  0[0m[1m vulnerabilities ignored[0m

+==============================================================================+
 [1mVULNERABILITIES REPORTED[0m 
+==============================================================================+

[31m-> Vulnerability found in starlette version 0.37.2[0m
[1m   Vulnerability ID: [0m78279
[1m   Affected spec: [0m<0.47.2
[1m   ADVISORY: [0mStarlette is a lightweight ASGI (Asynchronous Server
   Gateway Interface) framework/toolkit, designed for building async web
   services in Python. In versions 0.47.1 and below, when parsing a multi-
   part form with large files (greater than the default max spool size)
   starlette will block the main thread to roll the file over to disk. This
   blocks the event thread which means the application can't accept new
   connections. The UploadFile code has a minor bug where instead of just
   checking for self._in_memory, the logic should also check if the
   additional bytes will cause a rollover. The vulnerability is fixed in
   version 0.47.2.
[1m   CVE-2025-54121[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/78279/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 78279 in safetyâ€™s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in starlette version 0.37.2[0m
[1m   Vulnerability ID: [0m73725
[1m   Affected spec: [0m<0.40.0
[1m   ADVISORY: [0mAffected versions of the Starlette framework are
   vulnerable to Denial of Service (DoS) attacks due to the lack of
   restrictions on multipart part sizes. The vulnerability resides in the
   MultiPartParser class, which previously did not enforce size limits on
   incoming data. This issue is mitigated by introducing a max_part_size
   constraint and raises exceptions when limits are exceeded.
[1m   CVE-2024-47874[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/73725/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 73725 in safetyâ€™s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in python-jose version 3.5.0[0m
[1m   Vulnerability ID: [0m70716
[1m   Affected spec: [0m>=0
[1m   ADVISORY: [0mAffected versions of Python-jose allow attackers to
   cause a denial of service (resource consumption) during a decode via a
   crafted JSON Web Encryption (JWE) token with a high compression ratio, aka
   a "JWT bomb." This is similar to CVE-2024-21319.
[1m   CVE-2024-33664[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/70716/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 70716 in safetyâ€™s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in python-jose version 3.5.0[0m
[1m   Vulnerability ID: [0m70715
[1m   Affected spec: [0m>=0
[1m   ADVISORY: [0mAffected versions of Python-jose have a algorithm
   confusion vulnerability with OpenSSH ECDSA keys and other key formats.
   This is similar to CVE-2022-29217.
[1m   CVE-2024-33663[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/70715/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 70715 in safetyâ€™s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in pymongo version 4.5.0[0m
[1m   Vulnerability ID: [0m70626
[1m   Affected spec: [0m<4.6.3
[1m   ADVISORY: [0mVersions of the package pymongo before 4.6.3 are
   vulnerable to Out-of-bounds Read in the bson module. Using the crafted
   payload the attacker could force the parser to deserialize unmanaged
   memory. The parser tries to interpret bytes next to buffer and throws an
   exception with string. If the following bytes are not printable UTF-8 the
   parser throws an exception with a single byte.
[1m   CVE-2024-5629[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/70626/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 70626 in safetyâ€™s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in ecdsa version 0.19.1[0m
[1m   Vulnerability ID: [0m64459
[1m   Affected spec: [0m>=0
[1m   ADVISORY: [0mThe python-ecdsa library, which implements ECDSA
   cryptography in Python, is vulnerable to the Minerva attack
   (CVE-2024-23342). This vulnerability arises because scalar multiplication
   is not performed in constant time, affecting ECDSA signatures, key
   generation, and ECDH operations. ECDSA signature verification remains
   unaffected. The project maintainers have stated that there is no plan to
   release a fix for this vulnerability, citing their security policy:"As
   stated in the security policy, side-channel vulnerabilities are outside
   the scope of the project. This is not due to a lack of interest in side-
   channel secure implementations but rather because the main goal of the
   project is to be pure Python. Implementing side-channel-free code in pure
   Python is impossible. Therefore, we do not plan to release a fix for this
   vulnerability."NOTE: The specs we include in this advisory differ from the
   publicly available on other sources. That's because research by Safety CLI
   Cybersecurity Team confirms that there is no plan to address this
   vulnerability.
[1m   CVE-2024-23342[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/64459/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 64459 in safetyâ€™s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in ecdsa version 0.19.1[0m
[1m   Vulnerability ID: [0m64396
[1m   Affected spec: [0m>=0
[1m   ADVISORY: [0mEcdsa does not protects against side-channel attacks.
   This is because Python does not provide side-channel secure primitives
   (with the exception of hmac.compare_digest()), making side-channel secure
   programming impossible. For a sophisticated attacker observing just one
   operation with a private key will be sufficient to completely reconstruct
   the private key.https://pypi.org/project/ecdsa/#Security
[1m   PVE-2024-64396[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/64396/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 64396 in safetyâ€™s
   ignore command-line argument or add the ignore to your safety policy file.


+==============================================================================+
   [32m[1mREMEDIATIONS[0m

  7 vulnerabilities were reported in 4 packages. For detailed remediation & 
  fix recommendations, upgrade to a commercial license. 

+==============================================================================+

 Scan was completed. 7 vulnerabilities were reported. 

+==============================================================================+[0m


[33m[1m+===========================================================================================================================================================================================+[0m


[31m[1mDEPRECATED: [0m[33m[1mthis command (`check`) has been DEPRECATED, and will be unsupported beyond 01 June 2024.[0m


[32mWe highly encourage switching to the new [0m[32m[1m`scan`[0m[32m command which is easier to use, more powerful, and can be set up to mimic the deprecated command if required.[0m


[33m[1m+===========================================================================================================================================================================================+[0m



=== FASTAPI SMOKE (static) ===
fatal: app: no such path in the working tree.
Use 'git <command> -- <path>...' to specify paths that do not exist locally.
fatal: app: no such path in the working tree.
Use 'git <command> -- <path>...' to specify paths that do not exist locally.
fatal: app: no such path in the working tree.
Use 'git <command> -- <path>...' to specify paths that do not exist locally.

=== SECRET LEAKS (grep) ===
.gitlab-ci.yml:50:    - echo "$CI_REGISTRY_PASSWORD" | docker login -u "$CI_REGISTRY_USER" "$CI_REGISTRY" --password-stdin
.pre-commit-config.yaml:18:        entry: bash -c '! git grep -nE "(AWS_|API[_-]?KEY|SECRET|TOKEN|PASSWORD|PRIVATE KEY|BEGIN RSA)" -- . | grep -v ".env.example" | tee /dev/stderr'
ENTERPRISE_SECURITY_GATES.md:115:ðŸ” TS_CLIENT_SECRET = "[TradeStation Secret]" 
ENTERPRISE_SECURITY_GATES.md:117:ðŸ” ALPHA_VANTAGE_API_KEY = "[Alpha Vantage Key]"
ENTERPRISE_SECURITY_GATES.md:118:ðŸ” UW_API_TOKEN = "[Unusual Whales Token]"
GITLAB_WATERTIGHT.md:42:ðŸ” TS_CLIENT_SECRET     = [TradeStation Secret] (Protected âœ…, Masked âœ…)
GITLAB_WATERTIGHT.md:44:ðŸ” ALPHA_VANTAGE_API_KEY = [Alpha Vantage Key] (Protected âœ…, Masked âœ…)
GITLAB_WATERTIGHT.md:45:ðŸ” UW_API_TOKEN         = [Unusual Whales Token] (Protected âœ…, Masked âœ…)
TRADESTATION_STREAMING.md:11:TS_CLIENT_SECRET=YOUR_TS_CLIENT_SECRET
TRADESTATION_STREAMING.md:12:TS_REFRESH_TOKEN=YOUR_TS_REFRESH_TOKEN
audit_out/audit_20250824_204956/security.txt:6:/app/test_unusual_whales_direct.py:    api_token = os.getenv("UW_API_TOKEN")
audit_out/audit_20250824_204956/security.txt:12:/app/frontend/public/reports/flowmind_summary.html:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
audit_report.txt:322:=== SECRET LEAKS (grep) ===
audit_report.txt:323:.gitlab-ci.yml:50:    - echo "$CI_REGISTRY_PASSWORD" | docker login -u "$CI_REGISTRY_USER" "$CI_REGISTRY" --password-stdin
audit_report.txt:324:ENTERPRISE_SECURITY_GATES.md:115:ðŸ” TS_CLIENT_SECRET = "[TradeStation Secret]" 
audit_report.txt:325:ENTERPRISE_SECURITY_GATES.md:117:ðŸ” ALPHA_VANTAGE_API_KEY = "[Alpha Vantage Key]"
audit_report.txt:326:ENTERPRISE_SECURITY_GATES.md:118:ðŸ” UW_API_TOKEN = "[Unusual Whales Token]"
audit_report.txt:327:GITLAB_WATERTIGHT.md:42:ðŸ” TS_CLIENT_SECRET     = [TradeStation Secret] (Protected âœ…, Masked âœ…)
audit_report.txt:328:GITLAB_WATERTIGHT.md:44:ðŸ” ALPHA_VANTAGE_API_KEY = [Alpha Vantage Key] (Protected âœ…, Masked âœ…)
audit_report.txt:329:GITLAB_WATERTIGHT.md:45:ðŸ” UW_API_TOKEN         = [Unusual Whales Token] (Protected âœ…, Masked âœ…)
audit_report.txt:330:TRADESTATION_STREAMING.md:11:TS_CLIENT_SECRET=YOUR_TS_CLIENT_SECRET
audit_report.txt:331:TRADESTATION_STREAMING.md:12:TS_REFRESH_TOKEN=YOUR_TS_REFRESH_TOKEN
audit_report.txt:332:audit_out/audit_20250824_204956/security.txt:6:/app/test_unusual_whales_direct.py:    api_token = os.getenv("UW_API_TOKEN")
audit_report.txt:333:audit_out/audit_20250824_204956/security.txt:12:/app/frontend/public/reports/flowmind_summary.html:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
audit_report.txt:334:backend/.env:6:ALPHA_VANTAGE_API_KEY="7JVCXW6IR7YB9C3E"
audit_report.txt:335:backend/.env:7:UW_API_TOKEN="5809ee6a-bcb6-48ce-a16d-9f3bd634fd50"
audit_report.txt:336:backend/.env:15:TS_TOKEN="PLACEHOLDER_NEED_VALID_TS_OAUTH_TOKEN"
audit_report.txt:337:backend/.env:19:TRADESTATION_API_KEY="PLACEHOLDER_NEW_API_KEY_HERE"
audit_report.txt:338:backend/.env:20:TRADESTATION_API_SECRET="PLACEHOLDER_NEW_API_SECRET_HERE"
audit_report.txt:339:backend/.env:25:TS_TOKEN_URL="https://signin.tradestation.com/oauth/token"
audit_report.txt:340:backend/.env:27:TS_CLIENT_SECRET="PLACEHOLDER_NEW_CLIENT_SECRET_HERE"
audit_report.txt:341:backend/.env:28:TS_TOKEN_MARGIN_SEC=120
audit_report.txt:342:backend/app/config.py:9:TS_CLIENT_ID = os.getenv("TRADESTATION_API_KEY", "")
audit_report.txt:343:backend/app/config.py:10:TS_CLIENT_SECRET = os.getenv("TRADESTATION_API_SECRET", "")  
audit_report.txt:344:backend/app/config.py:14:TOKEN_SKEW_SECONDS = int(os.getenv("TOKEN_SKEW_SECONDS", "60"))  # Refresh 60s before expiration
audit_report.txt:345:backend/app/deps/tradestation.py:85:        "needs_refresh": expires_in <= 60  # TOKEN_SKEW_SECONDS
audit_report.txt:346:backend/app/routers/tradestation_auth.py:146:        from ..services.tradestation import _TOKENS
audit_report.txt:347:backend/app/routers/tradestation_auth.py:147:        if user_id in _TOKENS:
audit_report.txt:348:backend/app/routers/tradestation_auth.py:148:            del _TOKENS[user_id]
audit_report.txt:349:backend/app/services/tradestation.py:15:        TS_BASE_URL, TS_CLIENT_ID, TS_CLIENT_SECRET, TS_REDIRECT_URI, 
audit_report.txt:350:backend/app/services/tradestation.py:16:        TOKEN_SKEW_SECONDS, HTTP_TIMEOUT, MONGO_URL, DB_NAME
audit_report.txt:351:backend/app/services/tradestation.py:22:    TS_CLIENT_ID = os.getenv("TRADESTATION_API_KEY", "")
audit_report.txt:352:backend/app/services/tradestation.py:23:    TS_CLIENT_SECRET = os.getenv("TRADESTATION_API_SECRET", "")
audit_report.txt:353:backend/app/services/tradestation.py:25:    TOKEN_SKEW_SECONDS = 60
audit_report.txt:354:backend/app/services/tradestation.py:45:_TOKENS: Dict[str, Dict[str, Any]] = {}  # user_id -> {access_token, refresh_token, exp_ts}
audit_report.txt:355:backend/app/services/tradestation.py:56:    if user_id in _TOKENS:
audit_report.txt:356:backend/app/services/tradestation.py:57:        return _TOKENS[user_id]
audit_report.txt:357:backend/app/services/tradestation.py:70:                _TOKENS[user_id] = token_data
audit_report.txt:358:backend/app/services/tradestation.py:88:    _TOKENS[user_id] = token_data
audit_report.txt:359:backend/app/services/tradestation.py:113:    return int(time.time()) >= int(token.get("exp_ts", 0)) - TOKEN_SKEW_SECONDS
audit_report.txt:360:backend/app/services/tradestation.py:129:        "client_secret": TS_CLIENT_SECRET,
audit_report.txt:361:backend/app/services/tradestation.py:225:        config_ok = bool(TS_CLIENT_ID and TS_CLIENT_SECRET)
audit_report.txt:362:backend/app/services/tradestation.py:231:            "active_sessions": len(_TOKENS),
audit_report.txt:363:backend/database.py:89:            -- OAUTH TOKENS (TradeStation)
audit_report.txt:364:backend/integrations/ts_client.py:9:TS_TOKEN = os.getenv("TS_TOKEN")
audit_report.txt:365:backend/integrations/ts_client.py:14:        if not TS_TOKEN:
audit_report.txt:366:backend/integrations/ts_client.py:15:            raise RuntimeError("TS_TOKEN missing - need valid TradeStation OAuth token")
audit_report.txt:367:backend/integrations/ts_client.py:25:            headers = {"Authorization": f"Bearer {TS_TOKEN}"}
audit_report.txt:368:backend/integrations/ts_client.py:39:            headers = {"Authorization": f"Bearer {TS_TOKEN}"}
audit_report.txt:369:backend/iv_service/config.py:10:TS_TOKEN = os.getenv("TS_TOKEN", "")
audit_report.txt:370:backend/iv_service/provider_ts.py:3:from .config import TS_BASE_URL, TS_TOKEN
audit_report.txt:371:backend/iv_service/provider_ts.py:5:HEADERS = {"Authorization": f"Bearer {TS_TOKEN}"} if TS_TOKEN else {}
audit_report.txt:372:backend/server.py:69:ALPHA_VANTAGE_API_KEY = os.environ.get("ALPHA_VANTAGE_API_KEY")
audit_report.txt:373:backend/server.py:71:    TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
audit_report.txt:374:backend/server.py:72:    if ALPHA_VANTAGE_API_KEY
audit_report.txt:375:backend/server.py:76:    TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
audit_report.txt:376:backend/server.py:77:    if ALPHA_VANTAGE_API_KEY
audit_report.txt:377:backend/server.py.backup:69:ALPHA_VANTAGE_API_KEY = os.environ.get("ALPHA_VANTAGE_API_KEY")
audit_report.txt:378:backend/server.py.backup:71:    TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
audit_report.txt:379:backend/server.py.backup:72:    if ALPHA_VANTAGE_API_KEY
audit_report.txt:380:backend/server.py.backup:76:    TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
audit_report.txt:381:backend/server.py.backup:77:    if ALPHA_VANTAGE_API_KEY
audit_report.txt:382:backend/server_backup.py:30:ALPHA_VANTAGE_API_KEY = os.environ.get('ALPHA_VANTAGE_API_KEY')
audit_report.txt:383:backend/server_backup.py:31:ts = TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format='pandas')
audit_report.txt:384:backend/server_backup.py:32:ti = TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format='pandas')
audit_report.txt:385:backend/services/providers/uw_provider.py:13:        self.key = os.getenv("UW_API_TOKEN") or os.getenv("UW_API_KEY")
audit_report.txt:386:backend/services/ts_oauth.py:9:TS_TOKEN_URL = os.getenv("TS_TOKEN_URL", "https://signin.tradestation.com/oauth/token")
audit_report.txt:387:backend/services/ts_oauth.py:10:TS_CLIENT_ID = os.getenv("TS_CLIENT_ID", os.getenv("TRADESTATION_API_KEY"))
audit_report.txt:388:backend/services/ts_oauth.py:11:TS_CLIENT_SECRET = os.getenv("TS_CLIENT_SECRET", os.getenv("TRADESTATION_API_SECRET"))
audit_report.txt:389:backend/services/ts_oauth.py:14:    os.getenv("TS_TOKEN_MARGIN_SEC", "120")
audit_report.txt:390:backend/services/ts_oauth.py:75:        "client_secret": TS_CLIENT_SECRET,
audit_report.txt:391:backend/services/ts_oauth.py:77:    r = requests.post(TS_TOKEN_URL, data=data, timeout=15)
audit_report.txt:392:backend/services/uw_flow.py:10:TOKEN = os.getenv("UW_API_TOKEN")
audit_report.txt:393:backend/services/uw_flow.py:18:_hdr = lambda: {"Authorization": f"Bearer {TOKEN}"} if TOKEN else {}
audit_report.txt:394:backend/tradestation_auth.py:23:        self.client_id = os.getenv("TRADESTATION_API_KEY")
audit_report.txt:395:backend/tradestation_auth.py:24:        self.client_secret = os.getenv("TRADESTATION_API_SECRET")
audit_report.txt:396:backend/tradestation_auth_service.py:24:        self.client_id = os.getenv("TRADESTATION_API_KEY")
audit_report.txt:397:backend/tradestation_auth_service.py:25:        self.client_secret = os.getenv("TRADESTATION_API_SECRET")
audit_report.txt:398:backend/unusual_whales_service.py:26:        self.api_token = os.getenv("UNUSUAL_WHALES_API_KEY") or os.getenv("UW_API_TOKEN")
audit_report.txt:399:backend/unusual_whales_service.py:30:            logger.warning("UNUSUAL_WHALES_API_KEY or UW_API_TOKEN not set in environment variables")
audit_report.txt:400:backend/utils/security.py:5:SECRET_PATTERNS = [
audit_report.txt:401:backend/utils/security.py:20:    for pattern, replacement in SECRET_PATTERNS:
audit_report.txt:402:frontend/build/reports/flowmind_summary.html:168:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
audit_report.txt:403:frontend/public/reports/flowmind_summary.html:168:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
audit_report.txt:404:frontend/src/api/ohlcv/route.js:6:const TS_CLIENT_SECRET = process.env.TS_CLIENT_SECRET || "";
audit_report.txt:405:frontend/src/api/ohlcv/route.js:7:const TS_REFRESH_TOKEN = process.env.TS_REFRESH_TOKEN || "";
audit_report.txt:406:frontend/src/api/ohlcv/route.js:27:  if (!TS_REFRESH_TOKEN) {
audit_report.txt:407:frontend/src/api/ohlcv/route.js:28:    throw new Error("TS_REFRESH_TOKEN not configured");
audit_report.txt:408:frontend/src/api/ohlcv/route.js:34:    refresh_token: TS_REFRESH_TOKEN,
audit_report.txt:409:frontend/src/api/ohlcv/route.js:38:  if (TS_CLIENT_SECRET) {
audit_report.txt:410:frontend/src/api/ohlcv/route.js:39:    body.set("client_secret", TS_CLIENT_SECRET);
audit_report.txt:411:frontend/src/api/ohlcv/stream.js:6:const TS_CLIENT_SECRET = process.env.TS_CLIENT_SECRET || "";
audit_report.txt:412:frontend/src/api/ohlcv/stream.js:7:const TS_REFRESH_TOKEN = process.env.TS_REFRESH_TOKEN || "";
audit_report.txt:413:frontend/src/api/ohlcv/stream.js:27:  if (!TS_REFRESH_TOKEN) {
audit_report.txt:414:frontend/src/api/ohlcv/stream.js:28:    throw new Error("TS_REFRESH_TOKEN not configured");
audit_report.txt:415:frontend/src/api/ohlcv/stream.js:34:    refresh_token: TS_REFRESH_TOKEN,
audit_report.txt:416:frontend/src/api/ohlcv/stream.js:38:  if (TS_CLIENT_SECRET) {
audit_report.txt:417:frontend/src/api/ohlcv/stream.js:39:    body.set("client_secret", TS_CLIENT_SECRET);
audit_report.txt:418:frontend/src/components/TokenRefreshTest.js:29:        access_token: 'TEST_ACCESS_TOKEN_' + Date.now(),
audit_report.txt:419:frontend/src/components/TokenRefreshTest.js:30:        refresh_token: 'TEST_REFRESH_TOKEN_' + Date.now(),
audit_report.txt:420:go_no_go_backend_test.py:465:        print(f"ðŸ”— UW TOKEN STATUS: {self.uw_token_status.upper()}")
audit_report.txt:421:robust_tradestation_test.py:167:        print("\nðŸ” TESTING TOKEN MANAGEMENT ENDPOINTS")
audit_report.txt:422:robust_tradestation_test.py:588:        print("ðŸš€ ROBUST TRADESTATION TOKEN REFRESH SYSTEM - COMPREHENSIVE TEST")
audit_report.txt:423:robust_tradestation_test.py:609:        print("PHASE 2: TOKEN MANAGEMENT ENDPOINTS")
audit_report.txt:424:robust_tradestation_test.py:627:        print("FINAL RESULTS - ROBUST TRADESTATION TOKEN REFRESH SYSTEM")
audit_report.txt:425:scripts/gl_add_labels.sh:6:: "${GITLAB_TOKEN:?PAT with api scope}"
audit_report.txt:426:scripts/gl_add_labels.sh:9:  curl -sS --fail -H "PRIVATE-TOKEN: $GITLAB_TOKEN" \
audit_report.txt:427:test_result.md:568:TS_TOKEN_URL=https://signin.tradestation.com/oauth/token
audit_report.txt:428:test_result.md:570:TS_CLIENT_SECRET=NsAIybzKV6GbYGqQZwF0cHypdXfwiDYL5-EY4nRXEbIy748Zp-FdeuDXJIu6Jhwk
audit_report.txt:429:test_result.md:571:TS_TOKEN_MARGIN_SEC=120
audit_report.txt:430:test_result.md:625:- ðŸ”„ **Update .env** with new CLIENT_ID and CLIENT_SECRET  
audit_report.txt:431:test_result.md:891:          comment: "âœ… OPTIONS OVERVIEW ENDPOINT COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Successfully tested all 4 TradeStation integration endpoints as requested in review. âœ… ALL ENDPOINTS RESPONDING: GET /api/options/overview (default), GET /api/options/overview?symbol=ALL, GET /api/options/overview?symbol=TSLA all return HTTP 200 with proper JSON structure containing activeStrategies, expirationDates, dailyVolumeUsd, avgIvPct fields. Response times excellent (0.096s-0.424s). âœ… GRACEFUL ERROR HANDLING CONFIRMED: TradeStation API returning 401 Unauthorized due to placeholder token (TS_TOKEN='PLACEHOLDER_NEED_VALID_TS_OAUTH_TOKEN'), but system handles this gracefully by returning structured fallback data with zero values and proper source metadata indicating 'tradestation' provider. No crashes or 500 errors. âœ… SOURCE METADATA WORKING: All responses include proper source field showing 'chain': 'tradestation' and 'symbolUsed' indicating which symbol was used for data retrieval (SPY for ALL, TSLA for specific symbol). âœ… INTEGRATION ARCHITECTURE SOUND: TSClient properly configured, endpoints correctly routing through integration layer, error handling prevents UI crashes. System ready for production once valid TradeStation OAuth token is configured. SUCCESS RATE: 100% (3/3 overview endpoints working with graceful fallback). TradeStation integration architecture is production-ready and working correctly."
audit_report.txt:432:test_result.md:925:          comment: "ðŸŽ‰ TRADESTATION INTEGRATION AND TOKEN REFRESH COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of TradeStation integration and token refresh functionality as specifically requested in review. âœ… AUTHENTICATION ENDPOINTS WORKING PERFECTLY: GET /api/auth/tradestation/status returns complete authentication status (authenticated: true, has_access_token: true, has_refresh_token: true, environment: LIVE), GET /api/auth/tradestation/login generates proper OAuth URL with TradeStation domain and required parameters, POST /api/auth/tradestation/refresh successfully refreshes tokens with 'success' status. âœ… TRADESTATION API ENDPOINTS OPERATIONAL: GET /api/tradestation/accounts returns 2 accounts (11775499 Margin Active, 210MJP11 Futures Active) with complete account details, GET /api/tradestation/positions/11775499 returns 70 positions including stocks (AAPL 300 shares $68,424) and options with proper data structure, GET /api/tradestation/balances/11775499 returns comprehensive balance data with proper API response format. âœ… TOKEN AUTO-REFRESH MECHANISM VERIFIED: Initial authentication status shows needs_refresh: true, token refresh executed successfully in 0.756s, subsequent API calls work without issues, final authentication status shows authenticated: true with needs_refresh: false, confirming automatic token refresh is working correctly. âœ… CONNECTION STABILITY CONFIRMED: All 12 tests passed with 100% success rate, response times excellent (0.02-0.76s), no authentication failures or token expiration issues detected, all endpoints accessible via proper /api prefix. âœ… LIVE ENVIRONMENT INTEGRATION: System properly configured for LIVE TradeStation environment, real account data retrieved (not mock), proper OAuth flow with redirect_uri configured, token storage and persistence working correctly. SUCCESS RATE: 100% (12/12 tests passed, 7/7 phases completed). TradeStation integration and token refresh functionality is working perfectly and ready for production use with stable authentication and reliable API access."
audit_report.txt:433:test_result.md:937:          comment: "ðŸŽ¯ TRADESTATION TOKEN REFRESH AND API INTEGRATION TESTING COMPLETE - OUTSTANDING RESULTS: Conducted comprehensive testing of TradeStation token refresh functionality and API integration as requested in review. âœ… TOKEN REFRESH ENDPOINTS IMPLEMENTED: POST /api/auth/tradestation/refresh successfully refreshes expired tokens, returns proper success/error status, handles token expiration gracefully with automatic refresh mechanism. âœ… AUTHENTICATION FLOW COMPLETE: GET /api/auth/tradestation/status provides complete authentication status including token expiration times, GET /api/auth/tradestation/login generates proper OAuth URLs for user authentication, POST /api/auth/tradestation/callback handles OAuth callback processing. âœ… API INTEGRATION WORKING: All TradeStation API endpoints properly integrated with authentication system, automatic token refresh occurs before API calls when needed, no manual token management required by client applications, seamless integration with existing mindfolio management system. âœ… LIVE DATA ACCESS CONFIRMED: Real-time access to TradeStation LIVE environment, 2 active accounts accessible (11775499 Margin, 210MJP11 Futures), 70+ positions retrieved with accurate market values and P&L data, balance information accessible with comprehensive account details. âœ… ERROR HANDLING AND STABILITY: Proper error handling for expired tokens, graceful fallback when authentication fails, robust session management prevents token conflicts, all endpoints respond within acceptable timeframes (0.02-0.76s). SUCCESS RATE: 100% (all token refresh and API integration tests passed). TradeStation token refresh functionality is stable and reliable for production use."
audit_report.txt:434:test_result.md:1581:    - message: "ðŸŽ‰ TRADESTATION INTEGRATION AND TOKEN REFRESH TESTING COMPLETE - EXCELLENT RESULTS: Conducted comprehensive testing of TradeStation integration and token refresh functionality as specifically requested in review. âœ… ALL REQUESTED ENDPOINTS WORKING PERFECTLY: 1) GET /api/auth/tradestation/status - Authentication status check working (authenticated: true, LIVE environment, proper token management), 2) GET /api/auth/tradestation/login - Login URL generation working (proper OAuth URL with TradeStation domain), 3) POST /api/auth/tradestation/refresh - Token refresh working (successful refresh in 0.756s), 4) GET /api/tradestation/accounts - Accounts retrieval working (2 accounts: 11775499 Margin, 210MJP11 Futures), 5) GET /api/tradestation/positions/{account_id} - Positions retrieval working (70 positions with real market data), 6) GET /api/tradestation/balances/{account_id} - Balances retrieval working (comprehensive balance data). âœ… TOKEN AUTO-REFRESH MECHANISM VERIFIED: System automatically refreshes tokens when needed, no manual intervention required, seamless API access maintained, authentication status properly tracked throughout operations. âœ… CONNECTION STABILITY CONFIRMED: 100% success rate (12/12 tests passed), excellent response times (0.02-0.76s), no authentication failures, all endpoints accessible via proper /api prefix. âœ… LIVE ENVIRONMENT INTEGRATION: Real TradeStation LIVE environment access confirmed, authentic account data retrieved (not mock), proper OAuth flow configured, token storage and persistence working correctly. SUCCESS RATE: 100% (7/7 phases completed). TradeStation integration and token refresh functionality is working perfectly and ready for production use. All review requirements satisfied with stable authentication and reliable API access."
audit_report.txt:435:test_result.md:1877:        - comment: "ðŸŽ‰ OAUTH AUTHENTICATION FULLY OPERATIONAL: TradeStation OAuth system now successfully authenticated and connected to LIVE environment. âœ… AUTHENTICATION STATUS: authenticated: true, environment: LIVE, expires_in_minutes: 11, connection successful with 2 accounts found. âœ… API CONNECTIVITY: Successfully connected to TradeStation API (https://api.tradestation.com/v3) with proper credentials configured. âœ… TOKEN MANAGEMENT: Active authentication tokens with proper expiration tracking. âœ… LIVE ENVIRONMENT: Connected to real trading environment, not simulation. The OAuth authentication system is now fully functional and enabling access to live trading data and account balances."
audit_report.txt:436:test_result.md:1883:        - comment: "ðŸŽ‰ TRADESTATION AUTHENTICATION FLOW COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of complete TradeStation authentication flow as requested in review after callback URL fix (http://localhost:8080). âœ… AUTHENTICATION STATUS ENDPOINT: GET /api/auth/tradestation/status working perfectly (200 OK, 0.02s) with complete response structure showing authenticated: false, environment: LIVE, credentials_configured: true, base_url: https://api.tradestation.com/v3, redirect_uri: http://localhost:8080. âœ… OAUTH LOGIN ENDPOINT: GET /api/auth/tradestation/login working excellently (200 OK, 0.11s) generating proper OAuth URL (305 chars) with all required parameters (client_id=XEs0URG1rMrGDUFRKVhlDaclvQKq8Qpj, redirect_uri=http://localhost:8080, response_type=code, scope) and 4-step authentication instructions. âœ… CALLBACK ENDPOINT FUNCTIONALITY: GET /api/auth/tradestation/callback responding correctly with proper parameter validation (422 for missing code/state), handles mock authorization codes appropriately (500 with 'invalid_grant' error as expected), and processes token exchange requests properly. âœ… TOKEN EXCHANGE TESTING: Simulated token exchange with mock codes working as expected - endpoint correctly rejects invalid codes with proper error messages, validates required parameters, and handles edge cases (malformed codes, SQL injection attempts) securely. âœ… STATUS CONSISTENCY: Authentication status remains consistent throughout testing flow, properly tracking authentication state changes. âœ… ERROR HANDLING: Robust error handling for all edge cases including malformed codes, missing parameters, and security threats. âœ… PERFORMANCE: Excellent response times (0.02-0.26s) across all endpoints. âœ… COMPLETE FLOW INTEGRATION: All 5 authentication flow steps working (Status â†’ Login â†’ Callback â†’ Token Exchange â†’ Status). SUCCESS RATE: 100% (8/8 assessment criteria passed). All review requirements met: callback endpoint responds correctly, token exchange functionality tested, token storage and status checking verified, complete authentication status flow operational. TradeStation OAuth authentication system is fully functional and ready for production use with resolved callback URL (http://localhost:8080)."
audit_report.txt:437:test_result.md:2983:      message: "ðŸŽ‰ ROBUST TRADESTATION TOKEN REFRESH SYSTEM COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of the new robust TradeStation token refresh system as specifically requested in review. âœ… ROBUST SYSTEM INFRASTRUCTURE CONFIRMED: GET /api/auth/tradestation/health returns healthy status with MongoDB connected, TradeStation config configured, and active sessions tracking. Robust system available and operational with proper infrastructure. âœ… TOKEN MANAGEMENT WORKING EXCELLENTLY: Legacy endpoints functional due to routing conflicts but underlying robust system available. POST /api/auth/tradestation/refresh successfully refreshes tokens with 'success' status and proper timestamps. GET /api/auth/tradestation/status returns complete authentication status (authenticated: true, has_access_token: true, has_refresh_token: true, environment: LIVE) with token expiration times properly tracked (1200+ seconds validity after refresh). âœ… ROBUST FEATURES VERIFIED: Token refresh mechanism working correctly with successful refresh operations. Concurrent request handling excellent (5/5 requests successful in 0.06s, avg 0.01s per request) demonstrating robust concurrent handling. API integration stable with TradeStation accounts endpoint returning 2 active accounts (11775499 Margin, 210MJP11 Futures). Error handling working correctly (404 for non-existent endpoints). âœ… INTEGRATION PERFECT: All existing TradeStation endpoints working flawlessly - accounts endpoint returns 2 accounts, connection test successful, positions endpoint returns 70 positions for account 11775499. Authentication integration working properly with all required tokens present. Refresh mechanism integration working with API functioning correctly after refresh operations. âœ… P0 OBJECTIVES ASSESSMENT: 4/5 P0 objectives met - Refresh mechanism working (automat Ã®nainte de expirare), 0 401 errors in normal usage (0 erori 401 Ã®n utilizare normalÄƒ), concurrent request handling excellent (1 singur call de refresh pentru cereri simultane), status endpoint reporting correctly (status endpoint raporteazÄƒ corect expirarea Ã®n secunde). Only minor issue with health endpoint routing conflict (timeouts È™i retry cu backoff infrastructure confirmed). SUCCESS RATE: 95.5% (21/22 tests passed, 3/4 phases passed). VERDICT: Robust TradeStation token refresh system is working excellently with most P0 objectives met and should work reliably in production. System demonstrates robust token management, excellent concurrent handling, stable API integration, and proper error handling. ROUTING ISSUE IDENTIFIED: Legacy endpoints taking precedence over robust system due to mounting order in server.py - robust system available but not accessible due to route conflicts."
audit_report.txt:438:test_unusual_whales_direct.py:16:    api_token = os.getenv("UW_API_TOKEN")
audit_report.txt:439:tests/test_options_provider.py:7:    monkeypatch.setenv("UW_API_KEY", "test_key")
audit_report.txt:440:tests/test_options_provider.py:31:    monkeypatch.setenv("UW_API_KEY", "test_key")
audit_report.txt:441:tests/test_options_provider.py:51:    monkeypatch.setenv("UW_API_KEY", "test_key")
audit_report.txt:442:tests/test_smoke_contract.py:62:@pytest.mark.skipif(not os.getenv("TRADESTATION_API_KEY"), reason="TS creds absent")
audit_report.txt:443:tools/audit.sh:36:echo; echo "=== SECRET LEAKS (grep) ==="
audit_report.txt:444:tools/audit.sh:37:git grep -nE '(AWS_|API[_-]?KEY|SECRET|TOKEN|PASSWORD|PRIVATE KEY|BEGIN RSA)' -- ':!**/node_modules/**' ':!**/dist/**' || true
audit_report.txt:445:tradestation_development_test.py:269:        print("\nðŸ”„ TOKEN REFRESH MECHANISM TEST:")
audit_report.txt:446:tradestation_development_test.py:479:                "   ðŸ“ Need: TRADESTATION_API_KEY, TRADESTATION_API_SECRET"
backend/.env:7:UW_API_TOKEN=""  # REVOKED: 5809ee6a-bcb6-48ce-a16d-9f3bd634fd50 - Set new token in secure vault
backend/.env:15:TS_TOKEN=""  # OAuth token - populated dynamically via auth flow
backend/.env:19:TRADESTATION_API_KEY=""  # Set in secure environment
backend/.env:20:TRADESTATION_API_SECRET=""  # Set in secure environment
backend/.env:25:TS_TOKEN_URL="https://signin.tradestation.com/oauth/token"
backend/.env:27:TS_CLIENT_SECRET=""  # Set in secure environment
backend/.env:28:TS_TOKEN_MARGIN_SEC=120
backend/.env.example:5:UW_API_TOKEN="<set in vault>"
backend/.env.example:8:TS_TOKEN="<oauth token - populated dynamically>"
backend/.env.example:9:TRADESTATION_API_KEY="<set in vault>"
backend/.env.example:10:TRADESTATION_API_SECRET="<set in vault>"
backend/.env.example:11:TS_CLIENT_SECRET="<set in vault>"
backend/.env.example:15:TS_TOKEN_URL="https://signin.tradestation.com/oauth/token"
backend/.env.example:17:TS_TOKEN_MARGIN_SEC=120
backend/app/config.py:9:TS_CLIENT_ID = os.getenv("TRADESTATION_API_KEY", "")
backend/app/config.py:10:TS_CLIENT_SECRET = os.getenv("TRADESTATION_API_SECRET", "")  
backend/app/config.py:14:TOKEN_SKEW_SECONDS = int(os.getenv("TOKEN_SKEW_SECONDS", "60"))  # Refresh 60s before expiration
backend/app/deps/tradestation.py:85:        "needs_refresh": expires_in <= 60  # TOKEN_SKEW_SECONDS
backend/app/routers/tradestation_auth.py:146:        from ..services.tradestation import _TOKENS
backend/app/routers/tradestation_auth.py:147:        if user_id in _TOKENS:
backend/app/routers/tradestation_auth.py:148:            del _TOKENS[user_id]
backend/app/services/tradestation.py:15:        TS_BASE_URL, TS_CLIENT_ID, TS_CLIENT_SECRET, TS_REDIRECT_URI, 
backend/app/services/tradestation.py:16:        TOKEN_SKEW_SECONDS, HTTP_TIMEOUT, MONGO_URL, DB_NAME
backend/app/services/tradestation.py:22:    TS_CLIENT_ID = os.getenv("TRADESTATION_API_KEY", "")
backend/app/services/tradestation.py:23:    TS_CLIENT_SECRET = os.getenv("TRADESTATION_API_SECRET", "")
backend/app/services/tradestation.py:25:    TOKEN_SKEW_SECONDS = 60
backend/app/services/tradestation.py:45:_TOKENS: Dict[str, Dict[str, Any]] = {}  # user_id -> {access_token, refresh_token, exp_ts}
backend/app/services/tradestation.py:56:    if user_id in _TOKENS:
backend/app/services/tradestation.py:57:        return _TOKENS[user_id]
backend/app/services/tradestation.py:70:                _TOKENS[user_id] = token_data
backend/app/services/tradestation.py:88:    _TOKENS[user_id] = token_data
backend/app/services/tradestation.py:113:    return int(time.time()) >= int(token.get("exp_ts", 0)) - TOKEN_SKEW_SECONDS
backend/app/services/tradestation.py:129:        "client_secret": TS_CLIENT_SECRET,
backend/app/services/tradestation.py:225:        config_ok = bool(TS_CLIENT_ID and TS_CLIENT_SECRET)
backend/app/services/tradestation.py:231:            "active_sessions": len(_TOKENS),
backend/config.py:20:    uw_token: Optional[str] = Field(None, alias="UW_API_TOKEN")
backend/config.py:21:    ts_token: Optional[str] = Field(None, alias="TS_TOKEN")
backend/config.py:22:    ts_api_key: Optional[str] = Field(None, alias="TRADESTATION_API_KEY")
backend/config.py:23:    ts_api_secret: Optional[str] = Field(None, alias="TRADESTATION_API_SECRET")
backend/config.py:24:    ts_client_secret: Optional[str] = Field(None, alias="TS_CLIENT_SECRET")
backend/config.py:32:        "https://signin.tradestation.com/oauth/token", alias="TS_TOKEN_URL"
backend/config.py:35:    ts_token_margin_sec: int = Field(120, alias="TS_TOKEN_MARGIN_SEC")
backend/config.py:59:                missing_secrets.append("UW_API_TOKEN")
backend/config.py:61:                missing_secrets.append("TRADESTATION_API_KEY")
backend/config.py:72:                required_secrets.append("UW_API_TOKEN")
backend/config.py:74:                required_secrets.append("TRADESTATION_API_KEY")
backend/config.py:76:                required_secrets.append("TRADESTATION_API_SECRET")
backend/database.py:89:            -- OAUTH TOKENS (TradeStation)
backend/integrations/ts_client.py:9:TS_TOKEN = os.getenv("TS_TOKEN")
backend/integrations/ts_client.py:14:        if not TS_TOKEN:
backend/integrations/ts_client.py:15:            raise RuntimeError("TS_TOKEN missing - need valid TradeStation OAuth token")
backend/integrations/ts_client.py:25:            headers = {"Authorization": f"Bearer {TS_TOKEN}"}
backend/integrations/ts_client.py:39:            headers = {"Authorization": f"Bearer {TS_TOKEN}"}
backend/iv_service/config.py:10:TS_TOKEN = os.getenv("TS_TOKEN", "")
backend/iv_service/provider_ts.py:3:from .config import TS_BASE_URL, TS_TOKEN
backend/iv_service/provider_ts.py:5:HEADERS = {"Authorization": f"Bearer {TS_TOKEN}"} if TS_TOKEN else {}
backend/server.py.backup:69:ALPHA_VANTAGE_API_KEY = os.environ.get("ALPHA_VANTAGE_API_KEY")
backend/server.py.backup:71:    TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
backend/server.py.backup:72:    if ALPHA_VANTAGE_API_KEY
backend/server.py.backup:76:    TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
backend/server.py.backup:77:    if ALPHA_VANTAGE_API_KEY
backend/server_backup.py:30:ALPHA_VANTAGE_API_KEY = os.environ.get('ALPHA_VANTAGE_API_KEY')
backend/server_backup.py:31:ts = TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format='pandas')
backend/server_backup.py:32:ti = TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format='pandas')
backend/services/providers/uw_provider.py:13:        self.key = os.getenv("UW_API_TOKEN") or os.getenv("UW_API_KEY")
backend/services/ts_oauth.py:9:TS_TOKEN_URL = os.getenv("TS_TOKEN_URL", "https://signin.tradestation.com/oauth/token")
backend/services/ts_oauth.py:10:TS_CLIENT_ID = os.getenv("TS_CLIENT_ID", os.getenv("TRADESTATION_API_KEY"))
backend/services/ts_oauth.py:11:TS_CLIENT_SECRET = os.getenv("TS_CLIENT_SECRET", os.getenv("TRADESTATION_API_SECRET"))
backend/services/ts_oauth.py:14:    os.getenv("TS_TOKEN_MARGIN_SEC", "120")
backend/services/ts_oauth.py:75:        "client_secret": TS_CLIENT_SECRET,
backend/services/ts_oauth.py:77:    r = requests.post(TS_TOKEN_URL, data=data, timeout=15)
backend/services/uw_flow.py:10:TOKEN = os.getenv("UW_API_TOKEN")
backend/services/uw_flow.py:18:_hdr = lambda: {"Authorization": f"Bearer {TOKEN}"} if TOKEN else {}
backend/tradestation_auth.py:23:        self.client_id = os.getenv("TRADESTATION_API_KEY")
backend/tradestation_auth.py:24:        self.client_secret = os.getenv("TRADESTATION_API_SECRET")
backend/tradestation_auth_service.py:24:        self.client_id = os.getenv("TRADESTATION_API_KEY")
backend/tradestation_auth_service.py:25:        self.client_secret = os.getenv("TRADESTATION_API_SECRET")
backend/unusual_whales_service.py:26:        self.api_token = os.getenv("UNUSUAL_WHALES_API_KEY") or os.getenv("UW_API_TOKEN")
backend/unusual_whales_service.py:30:            logger.warning("UNUSUAL_WHALES_API_KEY or UW_API_TOKEN not set in environment variables")
backend/utils/security.py:5:SECRET_PATTERNS = [
backend/utils/security.py:20:    for pattern, replacement in SECRET_PATTERNS:
final_audit_report.txt:85:=== SECRET LEAKS (grep) ===
final_audit_report.txt:86:.gitlab-ci.yml:50:    - echo "$CI_REGISTRY_PASSWORD" | docker login -u "$CI_REGISTRY_USER" "$CI_REGISTRY" --password-stdin
final_audit_report.txt:87:.pre-commit-config.yaml:18:        entry: bash -c '! git grep -nE "(AWS_|API[_-]?KEY|SECRET|TOKEN|PASSWORD|PRIVATE KEY|BEGIN RSA)" -- . | grep -v ".env.example" | tee /dev/stderr'
final_audit_report.txt:88:ENTERPRISE_SECURITY_GATES.md:115:ðŸ” TS_CLIENT_SECRET = "[TradeStation Secret]" 
final_audit_report.txt:89:ENTERPRISE_SECURITY_GATES.md:117:ðŸ” ALPHA_VANTAGE_API_KEY = "[Alpha Vantage Key]"
final_audit_report.txt:90:ENTERPRISE_SECURITY_GATES.md:118:ðŸ” UW_API_TOKEN = "[Unusual Whales Token]"
final_audit_report.txt:91:GITLAB_WATERTIGHT.md:42:ðŸ” TS_CLIENT_SECRET     = [TradeStation Secret] (Protected âœ…, Masked âœ…)
final_audit_report.txt:92:GITLAB_WATERTIGHT.md:44:ðŸ” ALPHA_VANTAGE_API_KEY = [Alpha Vantage Key] (Protected âœ…, Masked âœ…)
final_audit_report.txt:93:GITLAB_WATERTIGHT.md:45:ðŸ” UW_API_TOKEN         = [Unusual Whales Token] (Protected âœ…, Masked âœ…)
final_audit_report.txt:94:TRADESTATION_STREAMING.md:11:TS_CLIENT_SECRET=YOUR_TS_CLIENT_SECRET
final_audit_report.txt:95:TRADESTATION_STREAMING.md:12:TS_REFRESH_TOKEN=YOUR_TS_REFRESH_TOKEN
final_audit_report.txt:96:audit_out/audit_20250824_204956/security.txt:6:/app/test_unusual_whales_direct.py:    api_token = os.getenv("UW_API_TOKEN")
final_audit_report.txt:97:audit_out/audit_20250824_204956/security.txt:12:/app/frontend/public/reports/flowmind_summary.html:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
final_audit_report.txt:98:audit_report.txt:322:=== SECRET LEAKS (grep) ===
final_audit_report.txt:99:audit_report.txt:323:.gitlab-ci.yml:50:    - echo "$CI_REGISTRY_PASSWORD" | docker login -u "$CI_REGISTRY_USER" "$CI_REGISTRY" --password-stdin
final_audit_report.txt:100:audit_report.txt:324:ENTERPRISE_SECURITY_GATES.md:115:ðŸ” TS_CLIENT_SECRET = "[TradeStation Secret]" 
final_audit_report.txt:101:audit_report.txt:325:ENTERPRISE_SECURITY_GATES.md:117:ðŸ” ALPHA_VANTAGE_API_KEY = "[Alpha Vantage Key]"
final_audit_report.txt:102:audit_report.txt:326:ENTERPRISE_SECURITY_GATES.md:118:ðŸ” UW_API_TOKEN = "[Unusual Whales Token]"
final_audit_report.txt:103:audit_report.txt:327:GITLAB_WATERTIGHT.md:42:ðŸ” TS_CLIENT_SECRET     = [TradeStation Secret] (Protected âœ…, Masked âœ…)
final_audit_report.txt:104:audit_report.txt:328:GITLAB_WATERTIGHT.md:44:ðŸ” ALPHA_VANTAGE_API_KEY = [Alpha Vantage Key] (Protected âœ…, Masked âœ…)
final_audit_report.txt:105:audit_report.txt:329:GITLAB_WATERTIGHT.md:45:ðŸ” UW_API_TOKEN         = [Unusual Whales Token] (Protected âœ…, Masked âœ…)
final_audit_report.txt:106:audit_report.txt:330:TRADESTATION_STREAMING.md:11:TS_CLIENT_SECRET=YOUR_TS_CLIENT_SECRET
final_audit_report.txt:107:audit_report.txt:331:TRADESTATION_STREAMING.md:12:TS_REFRESH_TOKEN=YOUR_TS_REFRESH_TOKEN
final_audit_report.txt:108:audit_report.txt:332:audit_out/audit_20250824_204956/security.txt:6:/app/test_unusual_whales_direct.py:    api_token = os.getenv("UW_API_TOKEN")
final_audit_report.txt:109:audit_report.txt:333:audit_out/audit_20250824_204956/security.txt:12:/app/frontend/public/reports/flowmind_summary.html:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
final_audit_report.txt:110:audit_report.txt:334:backend/.env:6:ALPHA_VANTAGE_API_KEY="7JVCXW6IR7YB9C3E"
final_audit_report.txt:111:audit_report.txt:335:backend/.env:7:UW_API_TOKEN="5809ee6a-bcb6-48ce-a16d-9f3bd634fd50"
final_audit_report.txt:112:audit_report.txt:336:backend/.env:15:TS_TOKEN="PLACEHOLDER_NEED_VALID_TS_OAUTH_TOKEN"
final_audit_report.txt:113:audit_report.txt:337:backend/.env:19:TRADESTATION_API_KEY="PLACEHOLDER_NEW_API_KEY_HERE"
final_audit_report.txt:114:audit_report.txt:338:backend/.env:20:TRADESTATION_API_SECRET="PLACEHOLDER_NEW_API_SECRET_HERE"
final_audit_report.txt:115:audit_report.txt:339:backend/.env:25:TS_TOKEN_URL="https://signin.tradestation.com/oauth/token"
final_audit_report.txt:116:audit_report.txt:340:backend/.env:27:TS_CLIENT_SECRET="PLACEHOLDER_NEW_CLIENT_SECRET_HERE"
final_audit_report.txt:117:audit_report.txt:341:backend/.env:28:TS_TOKEN_MARGIN_SEC=120
final_audit_report.txt:118:audit_report.txt:342:backend/app/config.py:9:TS_CLIENT_ID = os.getenv("TRADESTATION_API_KEY", "")
final_audit_report.txt:119:audit_report.txt:343:backend/app/config.py:10:TS_CLIENT_SECRET = os.getenv("TRADESTATION_API_SECRET", "")  
final_audit_report.txt:120:audit_report.txt:344:backend/app/config.py:14:TOKEN_SKEW_SECONDS = int(os.getenv("TOKEN_SKEW_SECONDS", "60"))  # Refresh 60s before expiration
final_audit_report.txt:121:audit_report.txt:345:backend/app/deps/tradestation.py:85:        "needs_refresh": expires_in <= 60  # TOKEN_SKEW_SECONDS
final_audit_report.txt:122:audit_report.txt:346:backend/app/routers/tradestation_auth.py:146:        from ..services.tradestation import _TOKENS
final_audit_report.txt:123:audit_report.txt:347:backend/app/routers/tradestation_auth.py:147:        if user_id in _TOKENS:
final_audit_report.txt:124:audit_report.txt:348:backend/app/routers/tradestation_auth.py:148:            del _TOKENS[user_id]
final_audit_report.txt:125:audit_report.txt:349:backend/app/services/tradestation.py:15:        TS_BASE_URL, TS_CLIENT_ID, TS_CLIENT_SECRET, TS_REDIRECT_URI, 
final_audit_report.txt:126:audit_report.txt:350:backend/app/services/tradestation.py:16:        TOKEN_SKEW_SECONDS, HTTP_TIMEOUT, MONGO_URL, DB_NAME
final_audit_report.txt:127:audit_report.txt:351:backend/app/services/tradestation.py:22:    TS_CLIENT_ID = os.getenv("TRADESTATION_API_KEY", "")
final_audit_report.txt:128:audit_report.txt:352:backend/app/services/tradestation.py:23:    TS_CLIENT_SECRET = os.getenv("TRADESTATION_API_SECRET", "")
final_audit_report.txt:129:audit_report.txt:353:backend/app/services/tradestation.py:25:    TOKEN_SKEW_SECONDS = 60
final_audit_report.txt:130:audit_report.txt:354:backend/app/services/tradestation.py:45:_TOKENS: Dict[str, Dict[str, Any]] = {}  # user_id -> {access_token, refresh_token, exp_ts}
final_audit_report.txt:131:audit_report.txt:355:backend/app/services/tradestation.py:56:    if user_id in _TOKENS:
final_audit_report.txt:132:audit_report.txt:356:backend/app/services/tradestation.py:57:        return _TOKENS[user_id]
final_audit_report.txt:133:audit_report.txt:357:backend/app/services/tradestation.py:70:                _TOKENS[user_id] = token_data
final_audit_report.txt:134:audit_report.txt:358:backend/app/services/tradestation.py:88:    _TOKENS[user_id] = token_data
final_audit_report.txt:135:audit_report.txt:359:backend/app/services/tradestation.py:113:    return int(time.time()) >= int(token.get("exp_ts", 0)) - TOKEN_SKEW_SECONDS
final_audit_report.txt:136:audit_report.txt:360:backend/app/services/tradestation.py:129:        "client_secret": TS_CLIENT_SECRET,
final_audit_report.txt:137:audit_report.txt:361:backend/app/services/tradestation.py:225:        config_ok = bool(TS_CLIENT_ID and TS_CLIENT_SECRET)
final_audit_report.txt:138:audit_report.txt:362:backend/app/services/tradestation.py:231:            "active_sessions": len(_TOKENS),
final_audit_report.txt:139:audit_report.txt:363:backend/database.py:89:            -- OAUTH TOKENS (TradeStation)
final_audit_report.txt:140:audit_report.txt:364:backend/integrations/ts_client.py:9:TS_TOKEN = os.getenv("TS_TOKEN")
final_audit_report.txt:141:audit_report.txt:365:backend/integrations/ts_client.py:14:        if not TS_TOKEN:
final_audit_report.txt:142:audit_report.txt:366:backend/integrations/ts_client.py:15:            raise RuntimeError("TS_TOKEN missing - need valid TradeStation OAuth token")
final_audit_report.txt:143:audit_report.txt:367:backend/integrations/ts_client.py:25:            headers = {"Authorization": f"Bearer {TS_TOKEN}"}
final_audit_report.txt:144:audit_report.txt:368:backend/integrations/ts_client.py:39:            headers = {"Authorization": f"Bearer {TS_TOKEN}"}
final_audit_report.txt:145:audit_report.txt:369:backend/iv_service/config.py:10:TS_TOKEN = os.getenv("TS_TOKEN", "")
final_audit_report.txt:146:audit_report.txt:370:backend/iv_service/provider_ts.py:3:from .config import TS_BASE_URL, TS_TOKEN
final_audit_report.txt:147:audit_report.txt:371:backend/iv_service/provider_ts.py:5:HEADERS = {"Authorization": f"Bearer {TS_TOKEN}"} if TS_TOKEN else {}
final_audit_report.txt:148:audit_report.txt:372:backend/server.py:69:ALPHA_VANTAGE_API_KEY = os.environ.get("ALPHA_VANTAGE_API_KEY")
final_audit_report.txt:149:audit_report.txt:373:backend/server.py:71:    TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
final_audit_report.txt:150:audit_report.txt:374:backend/server.py:72:    if ALPHA_VANTAGE_API_KEY
final_audit_report.txt:151:audit_report.txt:375:backend/server.py:76:    TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
final_audit_report.txt:152:audit_report.txt:376:backend/server.py:77:    if ALPHA_VANTAGE_API_KEY
final_audit_report.txt:153:audit_report.txt:377:backend/server.py.backup:69:ALPHA_VANTAGE_API_KEY = os.environ.get("ALPHA_VANTAGE_API_KEY")
final_audit_report.txt:154:audit_report.txt:378:backend/server.py.backup:71:    TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
final_audit_report.txt:155:audit_report.txt:379:backend/server.py.backup:72:    if ALPHA_VANTAGE_API_KEY
final_audit_report.txt:156:audit_report.txt:380:backend/server.py.backup:76:    TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
final_audit_report.txt:157:audit_report.txt:381:backend/server.py.backup:77:    if ALPHA_VANTAGE_API_KEY
final_audit_report.txt:158:audit_report.txt:382:backend/server_backup.py:30:ALPHA_VANTAGE_API_KEY = os.environ.get('ALPHA_VANTAGE_API_KEY')
final_audit_report.txt:159:audit_report.txt:383:backend/server_backup.py:31:ts = TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format='pandas')
final_audit_report.txt:160:audit_report.txt:384:backend/server_backup.py:32:ti = TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format='pandas')
final_audit_report.txt:161:audit_report.txt:385:backend/services/providers/uw_provider.py:13:        self.key = os.getenv("UW_API_TOKEN") or os.getenv("UW_API_KEY")
final_audit_report.txt:162:audit_report.txt:386:backend/services/ts_oauth.py:9:TS_TOKEN_URL = os.getenv("TS_TOKEN_URL", "https://signin.tradestation.com/oauth/token")
final_audit_report.txt:163:audit_report.txt:387:backend/services/ts_oauth.py:10:TS_CLIENT_ID = os.getenv("TS_CLIENT_ID", os.getenv("TRADESTATION_API_KEY"))
final_audit_report.txt:164:audit_report.txt:388:backend/services/ts_oauth.py:11:TS_CLIENT_SECRET = os.getenv("TS_CLIENT_SECRET", os.getenv("TRADESTATION_API_SECRET"))
final_audit_report.txt:165:audit_report.txt:389:backend/services/ts_oauth.py:14:    os.getenv("TS_TOKEN_MARGIN_SEC", "120")
final_audit_report.txt:166:audit_report.txt:390:backend/services/ts_oauth.py:75:        "client_secret": TS_CLIENT_SECRET,
final_audit_report.txt:167:audit_report.txt:391:backend/services/ts_oauth.py:77:    r = requests.post(TS_TOKEN_URL, data=data, timeout=15)
final_audit_report.txt:168:audit_report.txt:392:backend/services/uw_flow.py:10:TOKEN = os.getenv("UW_API_TOKEN")
final_audit_report.txt:169:audit_report.txt:393:backend/services/uw_flow.py:18:_hdr = lambda: {"Authorization": f"Bearer {TOKEN}"} if TOKEN else {}
final_audit_report.txt:170:audit_report.txt:394:backend/tradestation_auth.py:23:        self.client_id = os.getenv("TRADESTATION_API_KEY")
final_audit_report.txt:171:audit_report.txt:395:backend/tradestation_auth.py:24:        self.client_secret = os.getenv("TRADESTATION_API_SECRET")
final_audit_report.txt:172:audit_report.txt:396:backend/tradestation_auth_service.py:24:        self.client_id = os.getenv("TRADESTATION_API_KEY")
final_audit_report.txt:173:audit_report.txt:397:backend/tradestation_auth_service.py:25:        self.client_secret = os.getenv("TRADESTATION_API_SECRET")
final_audit_report.txt:174:audit_report.txt:398:backend/unusual_whales_service.py:26:        self.api_token = os.getenv("UNUSUAL_WHALES_API_KEY") or os.getenv("UW_API_TOKEN")
final_audit_report.txt:175:audit_report.txt:399:backend/unusual_whales_service.py:30:            logger.warning("UNUSUAL_WHALES_API_KEY or UW_API_TOKEN not set in environment variables")
final_audit_report.txt:176:audit_report.txt:400:backend/utils/security.py:5:SECRET_PATTERNS = [
final_audit_report.txt:177:audit_report.txt:401:backend/utils/security.py:20:    for pattern, replacement in SECRET_PATTERNS:
final_audit_report.txt:178:audit_report.txt:402:frontend/build/reports/flowmind_summary.html:168:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
final_audit_report.txt:179:audit_report.txt:403:frontend/public/reports/flowmind_summary.html:168:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
final_audit_report.txt:180:audit_report.txt:404:frontend/src/api/ohlcv/route.js:6:const TS_CLIENT_SECRET = process.env.TS_CLIENT_SECRET || "";
final_audit_report.txt:181:audit_report.txt:405:frontend/src/api/ohlcv/route.js:7:const TS_REFRESH_TOKEN = process.env.TS_REFRESH_TOKEN || "";
final_audit_report.txt:182:audit_report.txt:406:frontend/src/api/ohlcv/route.js:27:  if (!TS_REFRESH_TOKEN) {
final_audit_report.txt:183:audit_report.txt:407:frontend/src/api/ohlcv/route.js:28:    throw new Error("TS_REFRESH_TOKEN not configured");
final_audit_report.txt:184:audit_report.txt:408:frontend/src/api/ohlcv/route.js:34:    refresh_token: TS_REFRESH_TOKEN,
final_audit_report.txt:185:audit_report.txt:409:frontend/src/api/ohlcv/route.js:38:  if (TS_CLIENT_SECRET) {
final_audit_report.txt:186:audit_report.txt:410:frontend/src/api/ohlcv/route.js:39:    body.set("client_secret", TS_CLIENT_SECRET);
final_audit_report.txt:187:audit_report.txt:411:frontend/src/api/ohlcv/stream.js:6:const TS_CLIENT_SECRET = process.env.TS_CLIENT_SECRET || "";
final_audit_report.txt:188:audit_report.txt:412:frontend/src/api/ohlcv/stream.js:7:const TS_REFRESH_TOKEN = process.env.TS_REFRESH_TOKEN || "";
final_audit_report.txt:189:audit_report.txt:413:frontend/src/api/ohlcv/stream.js:27:  if (!TS_REFRESH_TOKEN) {
final_audit_report.txt:190:audit_report.txt:414:frontend/src/api/ohlcv/stream.js:28:    throw new Error("TS_REFRESH_TOKEN not configured");
final_audit_report.txt:191:audit_report.txt:415:frontend/src/api/ohlcv/stream.js:34:    refresh_token: TS_REFRESH_TOKEN,
final_audit_report.txt:192:audit_report.txt:416:frontend/src/api/ohlcv/stream.js:38:  if (TS_CLIENT_SECRET) {
final_audit_report.txt:193:audit_report.txt:417:frontend/src/api/ohlcv/stream.js:39:    body.set("client_secret", TS_CLIENT_SECRET);
final_audit_report.txt:194:audit_report.txt:418:frontend/src/components/TokenRefreshTest.js:29:        access_token: 'TEST_ACCESS_TOKEN_' + Date.now(),
final_audit_report.txt:195:audit_report.txt:419:frontend/src/components/TokenRefreshTest.js:30:        refresh_token: 'TEST_REFRESH_TOKEN_' + Date.now(),
final_audit_report.txt:196:audit_report.txt:420:go_no_go_backend_test.py:465:        print(f"ðŸ”— UW TOKEN STATUS: {self.uw_token_status.upper()}")
final_audit_report.txt:197:audit_report.txt:421:robust_tradestation_test.py:167:        print("\nðŸ” TESTING TOKEN MANAGEMENT ENDPOINTS")
final_audit_report.txt:198:audit_report.txt:422:robust_tradestation_test.py:588:        print("ðŸš€ ROBUST TRADESTATION TOKEN REFRESH SYSTEM - COMPREHENSIVE TEST")
final_audit_report.txt:199:audit_report.txt:423:robust_tradestation_test.py:609:        print("PHASE 2: TOKEN MANAGEMENT ENDPOINTS")
final_audit_report.txt:200:audit_report.txt:424:robust_tradestation_test.py:627:        print("FINAL RESULTS - ROBUST TRADESTATION TOKEN REFRESH SYSTEM")
final_audit_report.txt:201:audit_report.txt:425:scripts/gl_add_labels.sh:6:: "${GITLAB_TOKEN:?PAT with api scope}"
final_audit_report.txt:202:audit_report.txt:426:scripts/gl_add_labels.sh:9:  curl -sS --fail -H "PRIVATE-TOKEN: $GITLAB_TOKEN" \
final_audit_report.txt:203:audit_report.txt:427:test_result.md:568:TS_TOKEN_URL=https://signin.tradestation.com/oauth/token
final_audit_report.txt:204:audit_report.txt:428:test_result.md:570:TS_CLIENT_SECRET=NsAIybzKV6GbYGqQZwF0cHypdXfwiDYL5-EY4nRXEbIy748Zp-FdeuDXJIu6Jhwk
final_audit_report.txt:205:audit_report.txt:429:test_result.md:571:TS_TOKEN_MARGIN_SEC=120
final_audit_report.txt:206:audit_report.txt:430:test_result.md:625:- ðŸ”„ **Update .env** with new CLIENT_ID and CLIENT_SECRET  
final_audit_report.txt:207:audit_report.txt:431:test_result.md:891:          comment: "âœ… OPTIONS OVERVIEW ENDPOINT COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Successfully tested all 4 TradeStation integration endpoints as requested in review. âœ… ALL ENDPOINTS RESPONDING: GET /api/options/overview (default), GET /api/options/overview?symbol=ALL, GET /api/options/overview?symbol=TSLA all return HTTP 200 with proper JSON structure containing activeStrategies, expirationDates, dailyVolumeUsd, avgIvPct fields. Response times excellent (0.096s-0.424s). âœ… GRACEFUL ERROR HANDLING CONFIRMED: TradeStation API returning 401 Unauthorized due to placeholder token (TS_TOKEN='PLACEHOLDER_NEED_VALID_TS_OAUTH_TOKEN'), but system handles this gracefully by returning structured fallback data with zero values and proper source metadata indicating 'tradestation' provider. No crashes or 500 errors. âœ… SOURCE METADATA WORKING: All responses include proper source field showing 'chain': 'tradestation' and 'symbolUsed' indicating which symbol was used for data retrieval (SPY for ALL, TSLA for specific symbol). âœ… INTEGRATION ARCHITECTURE SOUND: TSClient properly configured, endpoints correctly routing through integration layer, error handling prevents UI crashes. System ready for production once valid TradeStation OAuth token is configured. SUCCESS RATE: 100% (3/3 overview endpoints working with graceful fallback). TradeStation integration architecture is production-ready and working correctly."
final_audit_report.txt:208:audit_report.txt:432:test_result.md:925:          comment: "ðŸŽ‰ TRADESTATION INTEGRATION AND TOKEN REFRESH COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of TradeStation integration and token refresh functionality as specifically requested in review. âœ… AUTHENTICATION ENDPOINTS WORKING PERFECTLY: GET /api/auth/tradestation/status returns complete authentication status (authenticated: true, has_access_token: true, has_refresh_token: true, environment: LIVE), GET /api/auth/tradestation/login generates proper OAuth URL with TradeStation domain and required parameters, POST /api/auth/tradestation/refresh successfully refreshes tokens with 'success' status. âœ… TRADESTATION API ENDPOINTS OPERATIONAL: GET /api/tradestation/accounts returns 2 accounts (11775499 Margin Active, 210MJP11 Futures Active) with complete account details, GET /api/tradestation/positions/11775499 returns 70 positions including stocks (AAPL 300 shares $68,424) and options with proper data structure, GET /api/tradestation/balances/11775499 returns comprehensive balance data with proper API response format. âœ… TOKEN AUTO-REFRESH MECHANISM VERIFIED: Initial authentication status shows needs_refresh: true, token refresh executed successfully in 0.756s, subsequent API calls work without issues, final authentication status shows authenticated: true with needs_refresh: false, confirming automatic token refresh is working correctly. âœ… CONNECTION STABILITY CONFIRMED: All 12 tests passed with 100% success rate, response times excellent (0.02-0.76s), no authentication failures or token expiration issues detected, all endpoints accessible via proper /api prefix. âœ… LIVE ENVIRONMENT INTEGRATION: System properly configured for LIVE TradeStation environment, real account data retrieved (not mock), proper OAuth flow with redirect_uri configured, token storage and persistence working correctly. SUCCESS RATE: 100% (12/12 tests passed, 7/7 phases completed). TradeStation integration and token refresh functionality is working perfectly and ready for production use with stable authentication and reliable API access."
final_audit_report.txt:209:audit_report.txt:433:test_result.md:937:          comment: "ðŸŽ¯ TRADESTATION TOKEN REFRESH AND API INTEGRATION TESTING COMPLETE - OUTSTANDING RESULTS: Conducted comprehensive testing of TradeStation token refresh functionality and API integration as requested in review. âœ… TOKEN REFRESH ENDPOINTS IMPLEMENTED: POST /api/auth/tradestation/refresh successfully refreshes expired tokens, returns proper success/error status, handles token expiration gracefully with automatic refresh mechanism. âœ… AUTHENTICATION FLOW COMPLETE: GET /api/auth/tradestation/status provides complete authentication status including token expiration times, GET /api/auth/tradestation/login generates proper OAuth URLs for user authentication, POST /api/auth/tradestation/callback handles OAuth callback processing. âœ… API INTEGRATION WORKING: All TradeStation API endpoints properly integrated with authentication system, automatic token refresh occurs before API calls when needed, no manual token management required by client applications, seamless integration with existing mindfolio management system. âœ… LIVE DATA ACCESS CONFIRMED: Real-time access to TradeStation LIVE environment, 2 active accounts accessible (11775499 Margin, 210MJP11 Futures), 70+ positions retrieved with accurate market values and P&L data, balance information accessible with comprehensive account details. âœ… ERROR HANDLING AND STABILITY: Proper error handling for expired tokens, graceful fallback when authentication fails, robust session management prevents token conflicts, all endpoints respond within acceptable timeframes (0.02-0.76s). SUCCESS RATE: 100% (all token refresh and API integration tests passed). TradeStation token refresh functionality is stable and reliable for production use."
final_audit_report.txt:210:audit_report.txt:434:test_result.md:1581:    - message: "ðŸŽ‰ TRADESTATION INTEGRATION AND TOKEN REFRESH TESTING COMPLETE - EXCELLENT RESULTS: Conducted comprehensive testing of TradeStation integration and token refresh functionality as specifically requested in review. âœ… ALL REQUESTED ENDPOINTS WORKING PERFECTLY: 1) GET /api/auth/tradestation/status - Authentication status check working (authenticated: true, LIVE environment, proper token management), 2) GET /api/auth/tradestation/login - Login URL generation working (proper OAuth URL with TradeStation domain), 3) POST /api/auth/tradestation/refresh - Token refresh working (successful refresh in 0.756s), 4) GET /api/tradestation/accounts - Accounts retrieval working (2 accounts: 11775499 Margin, 210MJP11 Futures), 5) GET /api/tradestation/positions/{account_id} - Positions retrieval working (70 positions with real market data), 6) GET /api/tradestation/balances/{account_id} - Balances retrieval working (comprehensive balance data). âœ… TOKEN AUTO-REFRESH MECHANISM VERIFIED: System automatically refreshes tokens when needed, no manual intervention required, seamless API access maintained, authentication status properly tracked throughout operations. âœ… CONNECTION STABILITY CONFIRMED: 100% success rate (12/12 tests passed), excellent response times (0.02-0.76s), no authentication failures, all endpoints accessible via proper /api prefix. âœ… LIVE ENVIRONMENT INTEGRATION: Real TradeStation LIVE environment access confirmed, authentic account data retrieved (not mock), proper OAuth flow configured, token storage and persistence working correctly. SUCCESS RATE: 100% (7/7 phases completed). TradeStation integration and token refresh functionality is working perfectly and ready for production use. All review requirements satisfied with stable authentication and reliable API access."
final_audit_report.txt:211:audit_report.txt:435:test_result.md:1877:        - comment: "ðŸŽ‰ OAUTH AUTHENTICATION FULLY OPERATIONAL: TradeStation OAuth system now successfully authenticated and connected to LIVE environment. âœ… AUTHENTICATION STATUS: authenticated: true, environment: LIVE, expires_in_minutes: 11, connection successful with 2 accounts found. âœ… API CONNECTIVITY: Successfully connected to TradeStation API (https://api.tradestation.com/v3) with proper credentials configured. âœ… TOKEN MANAGEMENT: Active authentication tokens with proper expiration tracking. âœ… LIVE ENVIRONMENT: Connected to real trading environment, not simulation. The OAuth authentication system is now fully functional and enabling access to live trading data and account balances."
final_audit_report.txt:212:audit_report.txt:436:test_result.md:1883:        - comment: "ðŸŽ‰ TRADESTATION AUTHENTICATION FLOW COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of complete TradeStation authentication flow as requested in review after callback URL fix (http://localhost:8080). âœ… AUTHENTICATION STATUS ENDPOINT: GET /api/auth/tradestation/status working perfectly (200 OK, 0.02s) with complete response structure showing authenticated: false, environment: LIVE, credentials_configured: true, base_url: https://api.tradestation.com/v3, redirect_uri: http://localhost:8080. âœ… OAUTH LOGIN ENDPOINT: GET /api/auth/tradestation/login working excellently (200 OK, 0.11s) generating proper OAuth URL (305 chars) with all required parameters (client_id=XEs0URG1rMrGDUFRKVhlDaclvQKq8Qpj, redirect_uri=http://localhost:8080, response_type=code, scope) and 4-step authentication instructions. âœ… CALLBACK ENDPOINT FUNCTIONALITY: GET /api/auth/tradestation/callback responding correctly with proper parameter validation (422 for missing code/state), handles mock authorization codes appropriately (500 with 'invalid_grant' error as expected), and processes token exchange requests properly. âœ… TOKEN EXCHANGE TESTING: Simulated token exchange with mock codes working as expected - endpoint correctly rejects invalid codes with proper error messages, validates required parameters, and handles edge cases (malformed codes, SQL injection attempts) securely. âœ… STATUS CONSISTENCY: Authentication status remains consistent throughout testing flow, properly tracking authentication state changes. âœ… ERROR HANDLING: Robust error handling for all edge cases including malformed codes, missing parameters, and security threats. âœ… PERFORMANCE: Excellent response times (0.02-0.26s) across all endpoints. âœ… COMPLETE FLOW INTEGRATION: All 5 authentication flow steps working (Status â†’ Login â†’ Callback â†’ Token Exchange â†’ Status). SUCCESS RATE: 100% (8/8 assessment criteria passed). All review requirements met: callback endpoint responds correctly, token exchange functionality tested, token storage and status checking verified, complete authentication status flow operational. TradeStation OAuth authentication system is fully functional and ready for production use with resolved callback URL (http://localhost:8080)."
final_audit_report.txt:213:audit_report.txt:437:test_result.md:2983:      message: "ðŸŽ‰ ROBUST TRADESTATION TOKEN REFRESH SYSTEM COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of the new robust TradeStation token refresh system as specifically requested in review. âœ… ROBUST SYSTEM INFRASTRUCTURE CONFIRMED: GET /api/auth/tradestation/health returns healthy status with MongoDB connected, TradeStation config configured, and active sessions tracking. Robust system available and operational with proper infrastructure. âœ… TOKEN MANAGEMENT WORKING EXCELLENTLY: Legacy endpoints functional due to routing conflicts but underlying robust system available. POST /api/auth/tradestation/refresh successfully refreshes tokens with 'success' status and proper timestamps. GET /api/auth/tradestation/status returns complete authentication status (authenticated: true, has_access_token: true, has_refresh_token: true, environment: LIVE) with token expiration times properly tracked (1200+ seconds validity after refresh). âœ… ROBUST FEATURES VERIFIED: Token refresh mechanism working correctly with successful refresh operations. Concurrent request handling excellent (5/5 requests successful in 0.06s, avg 0.01s per request) demonstrating robust concurrent handling. API integration stable with TradeStation accounts endpoint returning 2 active accounts (11775499 Margin, 210MJP11 Futures). Error handling working correctly (404 for non-existent endpoints). âœ… INTEGRATION PERFECT: All existing TradeStation endpoints working flawlessly - accounts endpoint returns 2 accounts, connection test successful, positions endpoint returns 70 positions for account 11775499. Authentication integration working properly with all required tokens present. Refresh mechanism integration working with API functioning correctly after refresh operations. âœ… P0 OBJECTIVES ASSESSMENT: 4/5 P0 objectives met - Refresh mechanism working (automat Ã®nainte de expirare), 0 401 errors in normal usage (0 erori 401 Ã®n utilizare normalÄƒ), concurrent request handling excellent (1 singur call de refresh pentru cereri simultane), status endpoint reporting correctly (status endpoint raporteazÄƒ corect expirarea Ã®n secunde). Only minor issue with health endpoint routing conflict (timeouts È™i retry cu backoff infrastructure confirmed). SUCCESS RATE: 95.5% (21/22 tests passed, 3/4 phases passed). VERDICT: Robust TradeStation token refresh system is working excellently with most P0 objectives met and should work reliably in production. System demonstrates robust token management, excellent concurrent handling, stable API integration, and proper error handling. ROUTING ISSUE IDENTIFIED: Legacy endpoints taking precedence over robust system due to mounting order in server.py - robust system available but not accessible due to route conflicts."
final_audit_report.txt:214:audit_report.txt:438:test_unusual_whales_direct.py:16:    api_token = os.getenv("UW_API_TOKEN")
final_audit_report.txt:215:audit_report.txt:439:tests/test_options_provider.py:7:    monkeypatch.setenv("UW_API_KEY", "test_key")
final_audit_report.txt:216:audit_report.txt:440:tests/test_options_provider.py:31:    monkeypatch.setenv("UW_API_KEY", "test_key")
final_audit_report.txt:217:audit_report.txt:441:tests/test_options_provider.py:51:    monkeypatch.setenv("UW_API_KEY", "test_key")
final_audit_report.txt:218:audit_report.txt:442:tests/test_smoke_contract.py:62:@pytest.mark.skipif(not os.getenv("TRADESTATION_API_KEY"), reason="TS creds absent")
final_audit_report.txt:219:audit_report.txt:443:tools/audit.sh:36:echo; echo "=== SECRET LEAKS (grep) ==="
final_audit_report.txt:220:audit_report.txt:444:tools/audit.sh:37:git grep -nE '(AWS_|API[_-]?KEY|SECRET|TOKEN|PASSWORD|PRIVATE KEY|BEGIN RSA)' -- ':!**/node_modules/**' ':!**/dist/**' || true
final_audit_report.txt:221:audit_report.txt:445:tradestation_development_test.py:269:        print("\nðŸ”„ TOKEN REFRESH MECHANISM TEST:")
final_audit_report.txt:222:audit_report.txt:446:tradestation_development_test.py:479:                "   ðŸ“ Need: TRADESTATION_API_KEY, TRADESTATION_API_SECRET"
final_audit_report.txt:223:backend/.env:7:UW_API_TOKEN=""  # REVOKED: 5809ee6a-bcb6-48ce-a16d-9f3bd634fd50 - Set new token in secure vault
final_audit_report.txt:224:backend/.env:15:TS_TOKEN=""  # OAuth token - populated dynamically via auth flow
final_audit_report.txt:225:backend/.env:19:TRADESTATION_API_KEY=""  # Set in secure environment
final_audit_report.txt:226:backend/.env:20:TRADESTATION_API_SECRET=""  # Set in secure environment
final_audit_report.txt:227:backend/.env:25:TS_TOKEN_URL="https://signin.tradestation.com/oauth/token"
final_audit_report.txt:228:backend/.env:27:TS_CLIENT_SECRET=""  # Set in secure environment
final_audit_report.txt:229:backend/.env:28:TS_TOKEN_MARGIN_SEC=120
final_audit_report.txt:230:backend/.env.example:5:UW_API_TOKEN="<set in vault>"
final_audit_report.txt:231:backend/.env.example:8:TS_TOKEN="<oauth token - populated dynamically>"
final_audit_report.txt:232:backend/.env.example:9:TRADESTATION_API_KEY="<set in vault>"
final_audit_report.txt:233:backend/.env.example:10:TRADESTATION_API_SECRET="<set in vault>"
final_audit_report.txt:234:backend/.env.example:11:TS_CLIENT_SECRET="<set in vault>"
final_audit_report.txt:235:backend/.env.example:15:TS_TOKEN_URL="https://signin.tradestation.com/oauth/token"
final_audit_report.txt:236:backend/.env.example:17:TS_TOKEN_MARGIN_SEC=120
final_audit_report.txt:237:backend/app/config.py:9:TS_CLIENT_ID = os.getenv("TRADESTATION_API_KEY", "")
final_audit_report.txt:238:backend/app/config.py:10:TS_CLIENT_SECRET = os.getenv("TRADESTATION_API_SECRET", "")  
final_audit_report.txt:239:backend/app/config.py:14:TOKEN_SKEW_SECONDS = int(os.getenv("TOKEN_SKEW_SECONDS", "60"))  # Refresh 60s before expiration
final_audit_report.txt:240:backend/app/deps/tradestation.py:85:        "needs_refresh": expires_in <= 60  # TOKEN_SKEW_SECONDS
final_audit_report.txt:241:backend/app/routers/tradestation_auth.py:146:        from ..services.tradestation import _TOKENS
final_audit_report.txt:242:backend/app/routers/tradestation_auth.py:147:        if user_id in _TOKENS:
final_audit_report.txt:243:backend/app/routers/tradestation_auth.py:148:            del _TOKENS[user_id]
final_audit_report.txt:244:backend/app/services/tradestation.py:15:        TS_BASE_URL, TS_CLIENT_ID, TS_CLIENT_SECRET, TS_REDIRECT_URI, 
final_audit_report.txt:245:backend/app/services/tradestation.py:16:        TOKEN_SKEW_SECONDS, HTTP_TIMEOUT, MONGO_URL, DB_NAME
final_audit_report.txt:246:backend/app/services/tradestation.py:22:    TS_CLIENT_ID = os.getenv("TRADESTATION_API_KEY", "")
final_audit_report.txt:247:backend/app/services/tradestation.py:23:    TS_CLIENT_SECRET = os.getenv("TRADESTATION_API_SECRET", "")
final_audit_report.txt:248:backend/app/services/tradestation.py:25:    TOKEN_SKEW_SECONDS = 60
final_audit_report.txt:249:backend/app/services/tradestation.py:45:_TOKENS: Dict[str, Dict[str, Any]] = {}  # user_id -> {access_token, refresh_token, exp_ts}
final_audit_report.txt:250:backend/app/services/tradestation.py:56:    if user_id in _TOKENS:
final_audit_report.txt:251:backend/app/services/tradestation.py:57:        return _TOKENS[user_id]
final_audit_report.txt:252:backend/app/services/tradestation.py:70:                _TOKENS[user_id] = token_data
final_audit_report.txt:253:backend/app/services/tradestation.py:88:    _TOKENS[user_id] = token_data
final_audit_report.txt:254:backend/app/services/tradestation.py:113:    return int(time.time()) >= int(token.get("exp_ts", 0)) - TOKEN_SKEW_SECONDS
final_audit_report.txt:255:backend/app/services/tradestation.py:129:        "client_secret": TS_CLIENT_SECRET,
final_audit_report.txt:256:backend/app/services/tradestation.py:225:        config_ok = bool(TS_CLIENT_ID and TS_CLIENT_SECRET)
final_audit_report.txt:257:backend/app/services/tradestation.py:231:            "active_sessions": len(_TOKENS),
final_audit_report.txt:258:backend/config.py:17:    uw_token: Optional[str] = Field(None, alias="UW_API_TOKEN")
final_audit_report.txt:259:backend/config.py:18:    ts_token: Optional[str] = Field(None, alias="TS_TOKEN")
final_audit_report.txt:260:backend/config.py:19:    ts_api_key: Optional[str] = Field(None, alias="TRADESTATION_API_KEY")
final_audit_report.txt:261:backend/config.py:20:    ts_api_secret: Optional[str] = Field(None, alias="TRADESTATION_API_SECRET")
final_audit_report.txt:262:backend/config.py:21:    ts_client_secret: Optional[str] = Field(None, alias="TS_CLIENT_SECRET")
final_audit_report.txt:263:backend/config.py:31:        "https://signin.tradestation.com/oauth/token", alias="TS_TOKEN_URL"
final_audit_report.txt:264:backend/config.py:34:    ts_token_margin_sec: int = Field(120, alias="TS_TOKEN_MARGIN_SEC")
final_audit_report.txt:265:backend/config.py:46:                missing_secrets.append("UW_API_TOKEN")
final_audit_report.txt:266:backend/config.py:48:                missing_secrets.append("TRADESTATION_API_KEY")
final_audit_report.txt:267:backend/config.py:59:                required_secrets.append("UW_API_TOKEN")
final_audit_report.txt:268:backend/config.py:61:                required_secrets.append("TRADESTATION_API_KEY")
final_audit_report.txt:269:backend/config.py:63:                required_secrets.append("TRADESTATION_API_SECRET")
final_audit_report.txt:270:backend/database.py:89:            -- OAUTH TOKENS (TradeStation)
final_audit_report.txt:271:backend/integrations/ts_client.py:9:TS_TOKEN = os.getenv("TS_TOKEN")
final_audit_report.txt:272:backend/integrations/ts_client.py:14:        if not TS_TOKEN:
final_audit_report.txt:273:backend/integrations/ts_client.py:15:            raise RuntimeError("TS_TOKEN missing - need valid TradeStation OAuth token")
final_audit_report.txt:274:backend/integrations/ts_client.py:25:            headers = {"Authorization": f"Bearer {TS_TOKEN}"}
final_audit_report.txt:275:backend/integrations/ts_client.py:39:            headers = {"Authorization": f"Bearer {TS_TOKEN}"}
final_audit_report.txt:276:backend/iv_service/config.py:10:TS_TOKEN = os.getenv("TS_TOKEN", "")
final_audit_report.txt:277:backend/iv_service/provider_ts.py:3:from .config import TS_BASE_URL, TS_TOKEN
final_audit_report.txt:278:backend/iv_service/provider_ts.py:5:HEADERS = {"Authorization": f"Bearer {TS_TOKEN}"} if TS_TOKEN else {}
final_audit_report.txt:279:backend/server.py.backup:69:ALPHA_VANTAGE_API_KEY = os.environ.get("ALPHA_VANTAGE_API_KEY")
final_audit_report.txt:280:backend/server.py.backup:71:    TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
final_audit_report.txt:281:backend/server.py.backup:72:    if ALPHA_VANTAGE_API_KEY
final_audit_report.txt:282:backend/server.py.backup:76:    TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format="pandas")
final_audit_report.txt:283:backend/server.py.backup:77:    if ALPHA_VANTAGE_API_KEY
final_audit_report.txt:284:backend/server_backup.py:30:ALPHA_VANTAGE_API_KEY = os.environ.get('ALPHA_VANTAGE_API_KEY')
final_audit_report.txt:285:backend/server_backup.py:31:ts = TimeSeries(key=ALPHA_VANTAGE_API_KEY, output_format='pandas')
final_audit_report.txt:286:backend/server_backup.py:32:ti = TechIndicators(key=ALPHA_VANTAGE_API_KEY, output_format='pandas')
final_audit_report.txt:287:backend/services/providers/uw_provider.py:13:        self.key = os.getenv("UW_API_TOKEN") or os.getenv("UW_API_KEY")
final_audit_report.txt:288:backend/services/ts_oauth.py:9:TS_TOKEN_URL = os.getenv("TS_TOKEN_URL", "https://signin.tradestation.com/oauth/token")
final_audit_report.txt:289:backend/services/ts_oauth.py:10:TS_CLIENT_ID = os.getenv("TS_CLIENT_ID", os.getenv("TRADESTATION_API_KEY"))
final_audit_report.txt:290:backend/services/ts_oauth.py:11:TS_CLIENT_SECRET = os.getenv("TS_CLIENT_SECRET", os.getenv("TRADESTATION_API_SECRET"))
final_audit_report.txt:291:backend/services/ts_oauth.py:14:    os.getenv("TS_TOKEN_MARGIN_SEC", "120")
final_audit_report.txt:292:backend/services/ts_oauth.py:75:        "client_secret": TS_CLIENT_SECRET,
final_audit_report.txt:293:backend/services/ts_oauth.py:77:    r = requests.post(TS_TOKEN_URL, data=data, timeout=15)
final_audit_report.txt:294:backend/services/uw_flow.py:10:TOKEN = os.getenv("UW_API_TOKEN")
final_audit_report.txt:295:backend/services/uw_flow.py:18:_hdr = lambda: {"Authorization": f"Bearer {TOKEN}"} if TOKEN else {}
final_audit_report.txt:296:backend/tradestation_auth.py:23:        self.client_id = os.getenv("TRADESTATION_API_KEY")
final_audit_report.txt:297:backend/tradestation_auth.py:24:        self.client_secret = os.getenv("TRADESTATION_API_SECRET")
final_audit_report.txt:298:backend/tradestation_auth_service.py:24:        self.client_id = os.getenv("TRADESTATION_API_KEY")
final_audit_report.txt:299:backend/tradestation_auth_service.py:25:        self.client_secret = os.getenv("TRADESTATION_API_SECRET")
final_audit_report.txt:300:backend/unusual_whales_service.py:26:        self.api_token = os.getenv("UNUSUAL_WHALES_API_KEY") or os.getenv("UW_API_TOKEN")
final_audit_report.txt:301:backend/unusual_whales_service.py:30:            logger.warning("UNUSUAL_WHALES_API_KEY or UW_API_TOKEN not set in environment variables")
final_audit_report.txt:302:backend/utils/security.py:5:SECRET_PATTERNS = [
final_audit_report.txt:303:backend/utils/security.py:20:    for pattern, replacement in SECRET_PATTERNS:
final_audit_report.txt:304:frontend/build/reports/flowmind_summary.html:168:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
final_audit_report.txt:305:frontend/public/reports/flowmind_summary.html:168:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
final_audit_report.txt:306:frontend/src/api/ohlcv/route.js:6:const TS_CLIENT_SECRET = process.env.TS_CLIENT_SECRET || "";
final_audit_report.txt:307:frontend/src/api/ohlcv/route.js:7:const TS_REFRESH_TOKEN = process.env.TS_REFRESH_TOKEN || "";
final_audit_report.txt:308:frontend/src/api/ohlcv/route.js:27:  if (!TS_REFRESH_TOKEN) {
final_audit_report.txt:309:frontend/src/api/ohlcv/route.js:28:    throw new Error("TS_REFRESH_TOKEN not configured");
final_audit_report.txt:310:frontend/src/api/ohlcv/route.js:34:    refresh_token: TS_REFRESH_TOKEN,
final_audit_report.txt:311:frontend/src/api/ohlcv/route.js:38:  if (TS_CLIENT_SECRET) {
final_audit_report.txt:312:frontend/src/api/ohlcv/route.js:39:    body.set("client_secret", TS_CLIENT_SECRET);
final_audit_report.txt:313:frontend/src/api/ohlcv/stream.js:6:const TS_CLIENT_SECRET = process.env.TS_CLIENT_SECRET || "";
final_audit_report.txt:314:frontend/src/api/ohlcv/stream.js:7:const TS_REFRESH_TOKEN = process.env.TS_REFRESH_TOKEN || "";
final_audit_report.txt:315:frontend/src/api/ohlcv/stream.js:27:  if (!TS_REFRESH_TOKEN) {
final_audit_report.txt:316:frontend/src/api/ohlcv/stream.js:28:    throw new Error("TS_REFRESH_TOKEN not configured");
final_audit_report.txt:317:frontend/src/api/ohlcv/stream.js:34:    refresh_token: TS_REFRESH_TOKEN,
final_audit_report.txt:318:frontend/src/api/ohlcv/stream.js:38:  if (TS_CLIENT_SECRET) {
final_audit_report.txt:319:frontend/src/api/ohlcv/stream.js:39:    body.set("client_secret", TS_CLIENT_SECRET);
final_audit_report.txt:320:frontend/src/components/TokenRefreshTest.js:29:        access_token: 'TEST_ACCESS_TOKEN_' + Date.now(),
final_audit_report.txt:321:frontend/src/components/TokenRefreshTest.js:30:        refresh_token: 'TEST_REFRESH_TOKEN_' + Date.now(),
final_audit_report.txt:322:go_no_go_backend_test.py:465:        print(f"ðŸ”— UW TOKEN STATUS: {self.uw_token_status.upper()}")
final_audit_report.txt:323:robust_tradestation_test.py:167:        print("\nðŸ” TESTING TOKEN MANAGEMENT ENDPOINTS")
final_audit_report.txt:324:robust_tradestation_test.py:588:        print("ðŸš€ ROBUST TRADESTATION TOKEN REFRESH SYSTEM - COMPREHENSIVE TEST")
final_audit_report.txt:325:robust_tradestation_test.py:609:        print("PHASE 2: TOKEN MANAGEMENT ENDPOINTS")
final_audit_report.txt:326:robust_tradestation_test.py:627:        print("FINAL RESULTS - ROBUST TRADESTATION TOKEN REFRESH SYSTEM")
final_audit_report.txt:327:scripts/gl_add_labels.sh:6:: "${GITLAB_TOKEN:?PAT with api scope}"
final_audit_report.txt:328:scripts/gl_add_labels.sh:9:  curl -sS --fail -H "PRIVATE-TOKEN: $GITLAB_TOKEN" \
final_audit_report.txt:329:test_result.md:568:TS_TOKEN_URL=https://signin.tradestation.com/oauth/token
final_audit_report.txt:330:test_result.md:570:TS_CLIENT_SECRET=NsAIybzKV6GbYGqQZwF0cHypdXfwiDYL5-EY4nRXEbIy748Zp-FdeuDXJIu6Jhwk
final_audit_report.txt:331:test_result.md:571:TS_TOKEN_MARGIN_SEC=120
final_audit_report.txt:332:test_result.md:625:- ðŸ”„ **Update .env** with new CLIENT_ID and CLIENT_SECRET  
final_audit_report.txt:333:test_result.md:891:          comment: "âœ… OPTIONS OVERVIEW ENDPOINT COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Successfully tested all 4 TradeStation integration endpoints as requested in review. âœ… ALL ENDPOINTS RESPONDING: GET /api/options/overview (default), GET /api/options/overview?symbol=ALL, GET /api/options/overview?symbol=TSLA all return HTTP 200 with proper JSON structure containing activeStrategies, expirationDates, dailyVolumeUsd, avgIvPct fields. Response times excellent (0.096s-0.424s). âœ… GRACEFUL ERROR HANDLING CONFIRMED: TradeStation API returning 401 Unauthorized due to placeholder token (TS_TOKEN='PLACEHOLDER_NEED_VALID_TS_OAUTH_TOKEN'), but system handles this gracefully by returning structured fallback data with zero values and proper source metadata indicating 'tradestation' provider. No crashes or 500 errors. âœ… SOURCE METADATA WORKING: All responses include proper source field showing 'chain': 'tradestation' and 'symbolUsed' indicating which symbol was used for data retrieval (SPY for ALL, TSLA for specific symbol). âœ… INTEGRATION ARCHITECTURE SOUND: TSClient properly configured, endpoints correctly routing through integration layer, error handling prevents UI crashes. System ready for production once valid TradeStation OAuth token is configured. SUCCESS RATE: 100% (3/3 overview endpoints working with graceful fallback). TradeStation integration architecture is production-ready and working correctly."
final_audit_report.txt:334:test_result.md:925:          comment: "ðŸŽ‰ TRADESTATION INTEGRATION AND TOKEN REFRESH COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of TradeStation integration and token refresh functionality as specifically requested in review. âœ… AUTHENTICATION ENDPOINTS WORKING PERFECTLY: GET /api/auth/tradestation/status returns complete authentication status (authenticated: true, has_access_token: true, has_refresh_token: true, environment: LIVE), GET /api/auth/tradestation/login generates proper OAuth URL with TradeStation domain and required parameters, POST /api/auth/tradestation/refresh successfully refreshes tokens with 'success' status. âœ… TRADESTATION API ENDPOINTS OPERATIONAL: GET /api/tradestation/accounts returns 2 accounts (11775499 Margin Active, 210MJP11 Futures Active) with complete account details, GET /api/tradestation/positions/11775499 returns 70 positions including stocks (AAPL 300 shares $68,424) and options with proper data structure, GET /api/tradestation/balances/11775499 returns comprehensive balance data with proper API response format. âœ… TOKEN AUTO-REFRESH MECHANISM VERIFIED: Initial authentication status shows needs_refresh: true, token refresh executed successfully in 0.756s, subsequent API calls work without issues, final authentication status shows authenticated: true with needs_refresh: false, confirming automatic token refresh is working correctly. âœ… CONNECTION STABILITY CONFIRMED: All 12 tests passed with 100% success rate, response times excellent (0.02-0.76s), no authentication failures or token expiration issues detected, all endpoints accessible via proper /api prefix. âœ… LIVE ENVIRONMENT INTEGRATION: System properly configured for LIVE TradeStation environment, real account data retrieved (not mock), proper OAuth flow with redirect_uri configured, token storage and persistence working correctly. SUCCESS RATE: 100% (12/12 tests passed, 7/7 phases completed). TradeStation integration and token refresh functionality is working perfectly and ready for production use with stable authentication and reliable API access."
final_audit_report.txt:335:test_result.md:937:          comment: "ðŸŽ¯ TRADESTATION TOKEN REFRESH AND API INTEGRATION TESTING COMPLETE - OUTSTANDING RESULTS: Conducted comprehensive testing of TradeStation token refresh functionality and API integration as requested in review. âœ… TOKEN REFRESH ENDPOINTS IMPLEMENTED: POST /api/auth/tradestation/refresh successfully refreshes expired tokens, returns proper success/error status, handles token expiration gracefully with automatic refresh mechanism. âœ… AUTHENTICATION FLOW COMPLETE: GET /api/auth/tradestation/status provides complete authentication status including token expiration times, GET /api/auth/tradestation/login generates proper OAuth URLs for user authentication, POST /api/auth/tradestation/callback handles OAuth callback processing. âœ… API INTEGRATION WORKING: All TradeStation API endpoints properly integrated with authentication system, automatic token refresh occurs before API calls when needed, no manual token management required by client applications, seamless integration with existing mindfolio management system. âœ… LIVE DATA ACCESS CONFIRMED: Real-time access to TradeStation LIVE environment, 2 active accounts accessible (11775499 Margin, 210MJP11 Futures), 70+ positions retrieved with accurate market values and P&L data, balance information accessible with comprehensive account details. âœ… ERROR HANDLING AND STABILITY: Proper error handling for expired tokens, graceful fallback when authentication fails, robust session management prevents token conflicts, all endpoints respond within acceptable timeframes (0.02-0.76s). SUCCESS RATE: 100% (all token refresh and API integration tests passed). TradeStation token refresh functionality is stable and reliable for production use."
final_audit_report.txt:336:test_result.md:1581:    - message: "ðŸŽ‰ TRADESTATION INTEGRATION AND TOKEN REFRESH TESTING COMPLETE - EXCELLENT RESULTS: Conducted comprehensive testing of TradeStation integration and token refresh functionality as specifically requested in review. âœ… ALL REQUESTED ENDPOINTS WORKING PERFECTLY: 1) GET /api/auth/tradestation/status - Authentication status check working (authenticated: true, LIVE environment, proper token management), 2) GET /api/auth/tradestation/login - Login URL generation working (proper OAuth URL with TradeStation domain), 3) POST /api/auth/tradestation/refresh - Token refresh working (successful refresh in 0.756s), 4) GET /api/tradestation/accounts - Accounts retrieval working (2 accounts: 11775499 Margin, 210MJP11 Futures), 5) GET /api/tradestation/positions/{account_id} - Positions retrieval working (70 positions with real market data), 6) GET /api/tradestation/balances/{account_id} - Balances retrieval working (comprehensive balance data). âœ… TOKEN AUTO-REFRESH MECHANISM VERIFIED: System automatically refreshes tokens when needed, no manual intervention required, seamless API access maintained, authentication status properly tracked throughout operations. âœ… CONNECTION STABILITY CONFIRMED: 100% success rate (12/12 tests passed), excellent response times (0.02-0.76s), no authentication failures, all endpoints accessible via proper /api prefix. âœ… LIVE ENVIRONMENT INTEGRATION: Real TradeStation LIVE environment access confirmed, authentic account data retrieved (not mock), proper OAuth flow configured, token storage and persistence working correctly. SUCCESS RATE: 100% (7/7 phases completed). TradeStation integration and token refresh functionality is working perfectly and ready for production use. All review requirements satisfied with stable authentication and reliable API access."
final_audit_report.txt:337:test_result.md:1877:        - comment: "ðŸŽ‰ OAUTH AUTHENTICATION FULLY OPERATIONAL: TradeStation OAuth system now successfully authenticated and connected to LIVE environment. âœ… AUTHENTICATION STATUS: authenticated: true, environment: LIVE, expires_in_minutes: 11, connection successful with 2 accounts found. âœ… API CONNECTIVITY: Successfully connected to TradeStation API (https://api.tradestation.com/v3) with proper credentials configured. âœ… TOKEN MANAGEMENT: Active authentication tokens with proper expiration tracking. âœ… LIVE ENVIRONMENT: Connected to real trading environment, not simulation. The OAuth authentication system is now fully functional and enabling access to live trading data and account balances."
final_audit_report.txt:338:test_result.md:1883:        - comment: "ðŸŽ‰ TRADESTATION AUTHENTICATION FLOW COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of complete TradeStation authentication flow as requested in review after callback URL fix (http://localhost:8080). âœ… AUTHENTICATION STATUS ENDPOINT: GET /api/auth/tradestation/status working perfectly (200 OK, 0.02s) with complete response structure showing authenticated: false, environment: LIVE, credentials_configured: true, base_url: https://api.tradestation.com/v3, redirect_uri: http://localhost:8080. âœ… OAUTH LOGIN ENDPOINT: GET /api/auth/tradestation/login working excellently (200 OK, 0.11s) generating proper OAuth URL (305 chars) with all required parameters (client_id=XEs0URG1rMrGDUFRKVhlDaclvQKq8Qpj, redirect_uri=http://localhost:8080, response_type=code, scope) and 4-step authentication instructions. âœ… CALLBACK ENDPOINT FUNCTIONALITY: GET /api/auth/tradestation/callback responding correctly with proper parameter validation (422 for missing code/state), handles mock authorization codes appropriately (500 with 'invalid_grant' error as expected), and processes token exchange requests properly. âœ… TOKEN EXCHANGE TESTING: Simulated token exchange with mock codes working as expected - endpoint correctly rejects invalid codes with proper error messages, validates required parameters, and handles edge cases (malformed codes, SQL injection attempts) securely. âœ… STATUS CONSISTENCY: Authentication status remains consistent throughout testing flow, properly tracking authentication state changes. âœ… ERROR HANDLING: Robust error handling for all edge cases including malformed codes, missing parameters, and security threats. âœ… PERFORMANCE: Excellent response times (0.02-0.26s) across all endpoints. âœ… COMPLETE FLOW INTEGRATION: All 5 authentication flow steps working (Status â†’ Login â†’ Callback â†’ Token Exchange â†’ Status). SUCCESS RATE: 100% (8/8 assessment criteria passed). All review requirements met: callback endpoint responds correctly, token exchange functionality tested, token storage and status checking verified, complete authentication status flow operational. TradeStation OAuth authentication system is fully functional and ready for production use with resolved callback URL (http://localhost:8080)."
final_audit_report.txt:339:test_result.md:2983:      message: "ðŸŽ‰ ROBUST TRADESTATION TOKEN REFRESH SYSTEM COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of the new robust TradeStation token refresh system as specifically requested in review. âœ… ROBUST SYSTEM INFRASTRUCTURE CONFIRMED: GET /api/auth/tradestation/health returns healthy status with MongoDB connected, TradeStation config configured, and active sessions tracking. Robust system available and operational with proper infrastructure. âœ… TOKEN MANAGEMENT WORKING EXCELLENTLY: Legacy endpoints functional due to routing conflicts but underlying robust system available. POST /api/auth/tradestation/refresh successfully refreshes tokens with 'success' status and proper timestamps. GET /api/auth/tradestation/status returns complete authentication status (authenticated: true, has_access_token: true, has_refresh_token: true, environment: LIVE) with token expiration times properly tracked (1200+ seconds validity after refresh). âœ… ROBUST FEATURES VERIFIED: Token refresh mechanism working correctly with successful refresh operations. Concurrent request handling excellent (5/5 requests successful in 0.06s, avg 0.01s per request) demonstrating robust concurrent handling. API integration stable with TradeStation accounts endpoint returning 2 active accounts (11775499 Margin, 210MJP11 Futures). Error handling working correctly (404 for non-existent endpoints). âœ… INTEGRATION PERFECT: All existing TradeStation endpoints working flawlessly - accounts endpoint returns 2 accounts, connection test successful, positions endpoint returns 70 positions for account 11775499. Authentication integration working properly with all required tokens present. Refresh mechanism integration working with API functioning correctly after refresh operations. âœ… P0 OBJECTIVES ASSESSMENT: 4/5 P0 objectives met - Refresh mechanism working (automat Ã®nainte de expirare), 0 401 errors in normal usage (0 erori 401 Ã®n utilizare normalÄƒ), concurrent request handling excellent (1 singur call de refresh pentru cereri simultane), status endpoint reporting correctly (status endpoint raporteazÄƒ corect expirarea Ã®n secunde). Only minor issue with health endpoint routing conflict (timeouts È™i retry cu backoff infrastructure confirmed). SUCCESS RATE: 95.5% (21/22 tests passed, 3/4 phases passed). VERDICT: Robust TradeStation token refresh system is working excellently with most P0 objectives met and should work reliably in production. System demonstrates robust token management, excellent concurrent handling, stable API integration, and proper error handling. ROUTING ISSUE IDENTIFIED: Legacy endpoints taking precedence over robust system due to mounting order in server.py - robust system available but not accessible due to route conflicts."
final_audit_report.txt:340:test_unusual_whales_direct.py:16:    api_token = os.getenv("UW_API_TOKEN")
final_audit_report.txt:341:tests/test_options_provider.py:7:    monkeypatch.setenv("UW_API_KEY", "test_key")
final_audit_report.txt:342:tests/test_options_provider.py:31:    monkeypatch.setenv("UW_API_KEY", "test_key")
final_audit_report.txt:343:tests/test_options_provider.py:51:    monkeypatch.setenv("UW_API_KEY", "test_key")
final_audit_report.txt:344:tests/test_smoke_contract.py:62:@pytest.mark.skipif(not os.getenv("TRADESTATION_API_KEY"), reason="TS creds absent")
final_audit_report.txt:345:tools/audit.sh:36:echo; echo "=== SECRET LEAKS (grep) ==="
final_audit_report.txt:346:tools/audit.sh:37:git grep -nE '(AWS_|API[_-]?KEY|SECRET|TOKEN|PASSWORD|PRIVATE KEY|BEGIN RSA)' -- ':!**/node_modules/**' ':!**/dist/**' || true
final_audit_report.txt:347:tradestation_development_test.py:269:        print("\nðŸ”„ TOKEN REFRESH MECHANISM TEST:")
final_audit_report.txt:348:tradestation_development_test.py:479:                "   ðŸ“ Need: TRADESTATION_API_KEY, TRADESTATION_API_SECRET"
frontend/build/reports/flowmind_summary.html:168:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
frontend/public/reports/flowmind_summary.html:168:      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/â€¦</span>, cheie Ã®n env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
frontend/src/api/ohlcv/route.js:6:const TS_CLIENT_SECRET = process.env.TS_CLIENT_SECRET || "";
frontend/src/api/ohlcv/route.js:7:const TS_REFRESH_TOKEN = process.env.TS_REFRESH_TOKEN || "";
frontend/src/api/ohlcv/route.js:27:  if (!TS_REFRESH_TOKEN) {
frontend/src/api/ohlcv/route.js:28:    throw new Error("TS_REFRESH_TOKEN not configured");
frontend/src/api/ohlcv/route.js:34:    refresh_token: TS_REFRESH_TOKEN,
frontend/src/api/ohlcv/route.js:38:  if (TS_CLIENT_SECRET) {
frontend/src/api/ohlcv/route.js:39:    body.set("client_secret", TS_CLIENT_SECRET);
frontend/src/api/ohlcv/stream.js:6:const TS_CLIENT_SECRET = process.env.TS_CLIENT_SECRET || "";
frontend/src/api/ohlcv/stream.js:7:const TS_REFRESH_TOKEN = process.env.TS_REFRESH_TOKEN || "";
frontend/src/api/ohlcv/stream.js:27:  if (!TS_REFRESH_TOKEN) {
frontend/src/api/ohlcv/stream.js:28:    throw new Error("TS_REFRESH_TOKEN not configured");
frontend/src/api/ohlcv/stream.js:34:    refresh_token: TS_REFRESH_TOKEN,
frontend/src/api/ohlcv/stream.js:38:  if (TS_CLIENT_SECRET) {
frontend/src/api/ohlcv/stream.js:39:    body.set("client_secret", TS_CLIENT_SECRET);
frontend/src/components/TokenRefreshTest.js:29:        access_token: 'TEST_ACCESS_TOKEN_' + Date.now(),
frontend/src/components/TokenRefreshTest.js:30:        refresh_token: 'TEST_REFRESH_TOKEN_' + Date.now(),
go_no_go_backend_test.py:465:        print(f"ðŸ”— UW TOKEN STATUS: {self.uw_token_status.upper()}")
k8s/deployment.yaml:31:            - name: ALPHA_VANTAGE_API_KEY
k8s/deployment.yaml:32:              valueFrom: { secretKeyRef: { name: app-secrets, key: ALPHA_VANTAGE_API_KEY } }
k8s/deployment.yaml:33:            - name: UW_API_TOKEN
k8s/deployment.yaml:34:              valueFrom: { secretKeyRef: { name: app-secrets, key: UW_API_TOKEN } }
k8s/deployment.yaml:35:            - name: TS_TOKEN
k8s/deployment.yaml:36:              valueFrom: { secretKeyRef: { name: app-secrets, key: TS_TOKEN } }
k8s/secret.example.yaml:7:  ALPHA_VANTAGE_API_KEY: "<set in vault>"
k8s/secret.example.yaml:8:  UW_API_TOKEN: "<set in vault>"
k8s/secret.example.yaml:9:  TS_TOKEN: "<set in vault>"
robust_tradestation_test.py:167:        print("\nðŸ” TESTING TOKEN MANAGEMENT ENDPOINTS")
robust_tradestation_test.py:588:        print("ðŸš€ ROBUST TRADESTATION TOKEN REFRESH SYSTEM - COMPREHENSIVE TEST")
robust_tradestation_test.py:609:        print("PHASE 2: TOKEN MANAGEMENT ENDPOINTS")
robust_tradestation_test.py:627:        print("FINAL RESULTS - ROBUST TRADESTATION TOKEN REFRESH SYSTEM")
scripts/gl_add_labels.sh:6:: "${GITLAB_TOKEN:?PAT with api scope}"
scripts/gl_add_labels.sh:9:  curl -sS --fail -H "PRIVATE-TOKEN: $GITLAB_TOKEN" \
test_result.md:568:TS_TOKEN_URL=https://signin.tradestation.com/oauth/token
test_result.md:570:TS_CLIENT_SECRET=NsAIybzKV6GbYGqQZwF0cHypdXfwiDYL5-EY4nRXEbIy748Zp-FdeuDXJIu6Jhwk
test_result.md:571:TS_TOKEN_MARGIN_SEC=120
test_result.md:625:- ðŸ”„ **Update .env** with new CLIENT_ID and CLIENT_SECRET  
test_result.md:891:          comment: "âœ… OPTIONS OVERVIEW ENDPOINT COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Successfully tested all 4 TradeStation integration endpoints as requested in review. âœ… ALL ENDPOINTS RESPONDING: GET /api/options/overview (default), GET /api/options/overview?symbol=ALL, GET /api/options/overview?symbol=TSLA all return HTTP 200 with proper JSON structure containing activeStrategies, expirationDates, dailyVolumeUsd, avgIvPct fields. Response times excellent (0.096s-0.424s). âœ… GRACEFUL ERROR HANDLING CONFIRMED: TradeStation API returning 401 Unauthorized due to placeholder token (TS_TOKEN='PLACEHOLDER_NEED_VALID_TS_OAUTH_TOKEN'), but system handles this gracefully by returning structured fallback data with zero values and proper source metadata indicating 'tradestation' provider. No crashes or 500 errors. âœ… SOURCE METADATA WORKING: All responses include proper source field showing 'chain': 'tradestation' and 'symbolUsed' indicating which symbol was used for data retrieval (SPY for ALL, TSLA for specific symbol). âœ… INTEGRATION ARCHITECTURE SOUND: TSClient properly configured, endpoints correctly routing through integration layer, error handling prevents UI crashes. System ready for production once valid TradeStation OAuth token is configured. SUCCESS RATE: 100% (3/3 overview endpoints working with graceful fallback). TradeStation integration architecture is production-ready and working correctly."
test_result.md:925:          comment: "ðŸŽ‰ TRADESTATION INTEGRATION AND TOKEN REFRESH COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of TradeStation integration and token refresh functionality as specifically requested in review. âœ… AUTHENTICATION ENDPOINTS WORKING PERFECTLY: GET /api/auth/tradestation/status returns complete authentication status (authenticated: true, has_access_token: true, has_refresh_token: true, environment: LIVE), GET /api/auth/tradestation/login generates proper OAuth URL with TradeStation domain and required parameters, POST /api/auth/tradestation/refresh successfully refreshes tokens with 'success' status. âœ… TRADESTATION API ENDPOINTS OPERATIONAL: GET /api/tradestation/accounts returns 2 accounts (11775499 Margin Active, 210MJP11 Futures Active) with complete account details, GET /api/tradestation/positions/11775499 returns 70 positions including stocks (AAPL 300 shares $68,424) and options with proper data structure, GET /api/tradestation/balances/11775499 returns comprehensive balance data with proper API response format. âœ… TOKEN AUTO-REFRESH MECHANISM VERIFIED: Initial authentication status shows needs_refresh: true, token refresh executed successfully in 0.756s, subsequent API calls work without issues, final authentication status shows authenticated: true with needs_refresh: false, confirming automatic token refresh is working correctly. âœ… CONNECTION STABILITY CONFIRMED: All 12 tests passed with 100% success rate, response times excellent (0.02-0.76s), no authentication failures or token expiration issues detected, all endpoints accessible via proper /api prefix. âœ… LIVE ENVIRONMENT INTEGRATION: System properly configured for LIVE TradeStation environment, real account data retrieved (not mock), proper OAuth flow with redirect_uri configured, token storage and persistence working correctly. SUCCESS RATE: 100% (12/12 tests passed, 7/7 phases completed). TradeStation integration and token refresh functionality is working perfectly and ready for production use with stable authentication and reliable API access."
test_result.md:937:          comment: "ðŸŽ¯ TRADESTATION TOKEN REFRESH AND API INTEGRATION TESTING COMPLETE - OUTSTANDING RESULTS: Conducted comprehensive testing of TradeStation token refresh functionality and API integration as requested in review. âœ… TOKEN REFRESH ENDPOINTS IMPLEMENTED: POST /api/auth/tradestation/refresh successfully refreshes expired tokens, returns proper success/error status, handles token expiration gracefully with automatic refresh mechanism. âœ… AUTHENTICATION FLOW COMPLETE: GET /api/auth/tradestation/status provides complete authentication status including token expiration times, GET /api/auth/tradestation/login generates proper OAuth URLs for user authentication, POST /api/auth/tradestation/callback handles OAuth callback processing. âœ… API INTEGRATION WORKING: All TradeStation API endpoints properly integrated with authentication system, automatic token refresh occurs before API calls when needed, no manual token management required by client applications, seamless integration with existing mindfolio management system. âœ… LIVE DATA ACCESS CONFIRMED: Real-time access to TradeStation LIVE environment, 2 active accounts accessible (11775499 Margin, 210MJP11 Futures), 70+ positions retrieved with accurate market values and P&L data, balance information accessible with comprehensive account details. âœ… ERROR HANDLING AND STABILITY: Proper error handling for expired tokens, graceful fallback when authentication fails, robust session management prevents token conflicts, all endpoints respond within acceptable timeframes (0.02-0.76s). SUCCESS RATE: 100% (all token refresh and API integration tests passed). TradeStation token refresh functionality is stable and reliable for production use."
test_result.md:1581:    - message: "ðŸŽ‰ TRADESTATION INTEGRATION AND TOKEN REFRESH TESTING COMPLETE - EXCELLENT RESULTS: Conducted comprehensive testing of TradeStation integration and token refresh functionality as specifically requested in review. âœ… ALL REQUESTED ENDPOINTS WORKING PERFECTLY: 1) GET /api/auth/tradestation/status - Authentication status check working (authenticated: true, LIVE environment, proper token management), 2) GET /api/auth/tradestation/login - Login URL generation working (proper OAuth URL with TradeStation domain), 3) POST /api/auth/tradestation/refresh - Token refresh working (successful refresh in 0.756s), 4) GET /api/tradestation/accounts - Accounts retrieval working (2 accounts: 11775499 Margin, 210MJP11 Futures), 5) GET /api/tradestation/positions/{account_id} - Positions retrieval working (70 positions with real market data), 6) GET /api/tradestation/balances/{account_id} - Balances retrieval working (comprehensive balance data). âœ… TOKEN AUTO-REFRESH MECHANISM VERIFIED: System automatically refreshes tokens when needed, no manual intervention required, seamless API access maintained, authentication status properly tracked throughout operations. âœ… CONNECTION STABILITY CONFIRMED: 100% success rate (12/12 tests passed), excellent response times (0.02-0.76s), no authentication failures, all endpoints accessible via proper /api prefix. âœ… LIVE ENVIRONMENT INTEGRATION: Real TradeStation LIVE environment access confirmed, authentic account data retrieved (not mock), proper OAuth flow configured, token storage and persistence working correctly. SUCCESS RATE: 100% (7/7 phases completed). TradeStation integration and token refresh functionality is working perfectly and ready for production use. All review requirements satisfied with stable authentication and reliable API access."
test_result.md:1877:        - comment: "ðŸŽ‰ OAUTH AUTHENTICATION FULLY OPERATIONAL: TradeStation OAuth system now successfully authenticated and connected to LIVE environment. âœ… AUTHENTICATION STATUS: authenticated: true, environment: LIVE, expires_in_minutes: 11, connection successful with 2 accounts found. âœ… API CONNECTIVITY: Successfully connected to TradeStation API (https://api.tradestation.com/v3) with proper credentials configured. âœ… TOKEN MANAGEMENT: Active authentication tokens with proper expiration tracking. âœ… LIVE ENVIRONMENT: Connected to real trading environment, not simulation. The OAuth authentication system is now fully functional and enabling access to live trading data and account balances."
test_result.md:1883:        - comment: "ðŸŽ‰ TRADESTATION AUTHENTICATION FLOW COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of complete TradeStation authentication flow as requested in review after callback URL fix (http://localhost:8080). âœ… AUTHENTICATION STATUS ENDPOINT: GET /api/auth/tradestation/status working perfectly (200 OK, 0.02s) with complete response structure showing authenticated: false, environment: LIVE, credentials_configured: true, base_url: https://api.tradestation.com/v3, redirect_uri: http://localhost:8080. âœ… OAUTH LOGIN ENDPOINT: GET /api/auth/tradestation/login working excellently (200 OK, 0.11s) generating proper OAuth URL (305 chars) with all required parameters (client_id=XEs0URG1rMrGDUFRKVhlDaclvQKq8Qpj, redirect_uri=http://localhost:8080, response_type=code, scope) and 4-step authentication instructions. âœ… CALLBACK ENDPOINT FUNCTIONALITY: GET /api/auth/tradestation/callback responding correctly with proper parameter validation (422 for missing code/state), handles mock authorization codes appropriately (500 with 'invalid_grant' error as expected), and processes token exchange requests properly. âœ… TOKEN EXCHANGE TESTING: Simulated token exchange with mock codes working as expected - endpoint correctly rejects invalid codes with proper error messages, validates required parameters, and handles edge cases (malformed codes, SQL injection attempts) securely. âœ… STATUS CONSISTENCY: Authentication status remains consistent throughout testing flow, properly tracking authentication state changes. âœ… ERROR HANDLING: Robust error handling for all edge cases including malformed codes, missing parameters, and security threats. âœ… PERFORMANCE: Excellent response times (0.02-0.26s) across all endpoints. âœ… COMPLETE FLOW INTEGRATION: All 5 authentication flow steps working (Status â†’ Login â†’ Callback â†’ Token Exchange â†’ Status). SUCCESS RATE: 100% (8/8 assessment criteria passed). All review requirements met: callback endpoint responds correctly, token exchange functionality tested, token storage and status checking verified, complete authentication status flow operational. TradeStation OAuth authentication system is fully functional and ready for production use with resolved callback URL (http://localhost:8080)."
test_result.md:2983:      message: "ðŸŽ‰ ROBUST TRADESTATION TOKEN REFRESH SYSTEM COMPREHENSIVE TESTING COMPLETE - EXCELLENT RESULTS: Conducted extensive testing of the new robust TradeStation token refresh system as specifically requested in review. âœ… ROBUST SYSTEM INFRASTRUCTURE CONFIRMED: GET /api/auth/tradestation/health returns healthy status with MongoDB connected, TradeStation config configured, and active sessions tracking. Robust system available and operational with proper infrastructure. âœ… TOKEN MANAGEMENT WORKING EXCELLENTLY: Legacy endpoints functional due to routing conflicts but underlying robust system available. POST /api/auth/tradestation/refresh successfully refreshes tokens with 'success' status and proper timestamps. GET /api/auth/tradestation/status returns complete authentication status (authenticated: true, has_access_token: true, has_refresh_token: true, environment: LIVE) with token expiration times properly tracked (1200+ seconds validity after refresh). âœ… ROBUST FEATURES VERIFIED: Token refresh mechanism working correctly with successful refresh operations. Concurrent request handling excellent (5/5 requests successful in 0.06s, avg 0.01s per request) demonstrating robust concurrent handling. API integration stable with TradeStation accounts endpoint returning 2 active accounts (11775499 Margin, 210MJP11 Futures). Error handling working correctly (404 for non-existent endpoints). âœ… INTEGRATION PERFECT: All existing TradeStation endpoints working flawlessly - accounts endpoint returns 2 accounts, connection test successful, positions endpoint returns 70 positions for account 11775499. Authentication integration working properly with all required tokens present. Refresh mechanism integration working with API functioning correctly after refresh operations. âœ… P0 OBJECTIVES ASSESSMENT: 4/5 P0 objectives met - Refresh mechanism working (automat Ã®nainte de expirare), 0 401 errors in normal usage (0 erori 401 Ã®n utilizare normalÄƒ), concurrent request handling excellent (1 singur call de refresh pentru cereri simultane), status endpoint reporting correctly (status endpoint raporteazÄƒ corect expirarea Ã®n secunde). Only minor issue with health endpoint routing conflict (timeouts È™i retry cu backoff infrastructure confirmed). SUCCESS RATE: 95.5% (21/22 tests passed, 3/4 phases passed). VERDICT: Robust TradeStation token refresh system is working excellently with most P0 objectives met and should work reliably in production. System demonstrates robust token management, excellent concurrent handling, stable API integration, and proper error handling. ROUTING ISSUE IDENTIFIED: Legacy endpoints taking precedence over robust system due to mounting order in server.py - robust system available but not accessible due to route conflicts."
test_unusual_whales_direct.py:16:    api_token = os.getenv("UW_API_TOKEN")
tests/test_options_provider.py:7:    monkeypatch.setenv("UW_API_KEY", "test_key")
tests/test_options_provider.py:31:    monkeypatch.setenv("UW_API_KEY", "test_key")
tests/test_options_provider.py:51:    monkeypatch.setenv("UW_API_KEY", "test_key")
tests/test_smoke_contract.py:62:@pytest.mark.skipif(not os.getenv("TRADESTATION_API_KEY"), reason="TS creds absent")
tools/audit.sh:36:echo; echo "=== SECRET LEAKS (grep) ==="
tools/audit.sh:37:git grep -nE '(AWS_|API[_-]?KEY|SECRET|TOKEN|PASSWORD|PRIVATE KEY|BEGIN RSA)' -- ':!**/node_modules/**' ':!**/dist/**' || true
tradestation_development_test.py:269:        print("\nðŸ”„ TOKEN REFRESH MECHANISM TEST:")
tradestation_development_test.py:479:                "   ðŸ“ Need: TRADESTATION_API_KEY, TRADESTATION_API_SECRET"

=== MONGO HOT PATHS ===
fatal: app: no such path in the working tree.
Use 'git <command> -- <path>...' to specify paths that do not exist locally.

=== FRONTEND BUNDLE RED FLAGS ===
fatal: ambiguous argument 'src': unknown revision or path not in the working tree.
Use '--' to separate paths from revisions, like this:
'git <command> [<revision>...] -- [<file>...]'
fatal: ambiguous argument 'src': unknown revision or path not in the working tree.
Use '--' to separate paths from revisions, like this:
'git <command> [<revision>...] -- [<file>...]'

=== SUMMARY DONE ===
