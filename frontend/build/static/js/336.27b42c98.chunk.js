"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[336],{6336:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var a=s(9379),l=s(5043),o=s(6767),i=s(108),n=s(5748),r=s(7734),c=s(2185),d=s(760),x=s(379),m=s(8791),h=s(6992),u=s(6102),p=s(7869),g=s(2458),b=s(751),v=s(5469),j=s(516),y=s(7104),f=s(8646),N=s(3033),k=s(7033),w=s(9722),_=s(579);const A="".concat("https://tradesmartview.preview.emergentagent.com","/api"),S=()=>{var e,t,s;const{portfolioId:S}=(0,o.g)(),C=(0,o.Zp)(),[P,L]=(0,l.useState)("closed"),[F,z]=(0,l.useState)("combined"),[T,K]=(0,l.useState)("all"),[$,B]=(0,l.useState)(!1),[D,O]=(0,l.useState)({start:"",end:""}),[E,W]=(0,l.useState)(!0),[M,R]=(0,l.useState)(null),[U,V]=(0,l.useState)([]),[G,I]=(0,l.useState)([]),[H,X]=(0,l.useState)(null),Y={stocks:"#10B981",options:"#3B82F6",combined:"#F59E0B",profit:"#10B981",loss:"#EF4444"},Z={"portfolio-1":{name:"Portfolio 1",value:125450,cash:25e3},"portfolio-2":{name:"Portfolio 2",value:89230,cash:15e3},"portfolio-3":{name:"Portfolio 3",value:205890,cash:35e3},"htech-15t":{name:"HTech 15T",value:139902.6,cash:1e5}},q=Z[S]||Z["htech-15t"],J=async()=>{W(!0),X(null);try{var e,t,s,l,o,i,n,r;const c=(0,a.A)({filter:P,asset_type:F,timeframe:T},"custom"===T&&D.start&&D.end?{start_date:D.start,end_date:D.end}:{}),d=await w.A.get("".concat(A,"/portfolio/").concat(S,"/performance"),{params:c});V((null===(e=d.data)||void 0===e?void 0:e.performance_data)||[]);const x=await w.A.get("".concat(A,"/portfolio/").concat(S,"/allocation"),{params:c});I((null===(t=x.data)||void 0===t?void 0:t.allocation_data)||[]),R({total_value:(null===(s=d.data)||void 0===s||null===(l=s.portfolio_summary)||void 0===l?void 0:l.total_value)||q.value,total_pnl:(null===(o=d.data)||void 0===o||null===(i=o.portfolio_summary)||void 0===i?void 0:i.total_pnl)||0,cash_balance:(null===(n=d.data)||void 0===n||null===(r=n.portfolio_summary)||void 0===r?void 0:r.cash_balance)||q.cash})}catch(c){console.error("Error fetching portfolio charts data:",c),X("Failed to load portfolio charts data"),Q()}finally{W(!1)}},Q=()=>{const e=[];for(let t=29;t>=0;t--){const s=new Date;s.setDate(s.getDate()-t);const a=s.toISOString().split("T")[0],l=1e3,o=100*Math.sin(.2*t)+50*Math.random()-25;e.push({date:a,stocks_pnl:l+o,options_pnl:.3*l+.5*o,combined_pnl:1.3*l+1.2*o,cumulative_stocks:l+o+10*t,cumulative_options:.3*l+.5*o+3*t,cumulative_combined:1.3*l+1.2*o+13*t})}V(e),I([{name:"AAPL",value:25e3,type:"stocks",count:5},{name:"MSFT",value:2e4,type:"stocks",count:3},{name:"GOOGL",value:15e3,type:"stocks",count:2},{name:"TSLA Calls",value:8e3,type:"options",count:10},{name:"SPY Puts",value:5e3,type:"options",count:5},{name:"NVDA",value:12e3,type:"stocks",count:4}]),R({total_value:q.value,total_pnl:2500.75,cash_balance:q.cash})};(0,l.useEffect)((()=>{J()}),[S,P,F,T,D]);const ee=(0,l.useMemo)((()=>U.map((e=>"stocks"===F?(0,a.A)((0,a.A)({},e),{},{pnl:e.stocks_pnl,cumulative:e.cumulative_stocks}):"options"===F?(0,a.A)((0,a.A)({},e),{},{pnl:e.options_pnl,cumulative:e.cumulative_options}):(0,a.A)((0,a.A)({},e),{},{pnl:e.combined_pnl,cumulative:e.cumulative_combined})))),[U,F]),te=(0,l.useMemo)((()=>"combined"===F?G:G.filter((e=>e.type===F))),[G,F]),se=e=>{let{active:t,payload:s,label:a}=e;return t&&s&&s.length?(0,_.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[(0,_.jsx)("p",{className:"font-medium",children:a}),s.map(((e,t)=>{var s;return(0,_.jsxs)("p",{style:{color:e.color},children:[e.name,": $",null===(s=e.value)||void 0===s?void 0:s.toFixed(2)]},t)}))]}):null};return E?(0,_.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,_.jsxs)("div",{className:"text-center",children:[(0,_.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,_.jsx)("p",{className:"text-gray-600",children:"Loading portfolio charts..."})]})}):(0,_.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,_.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,_.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,_.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,_.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,_.jsx)("button",{onClick:()=>C("/portfolios/".concat(S)),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,_.jsx)(v.A,{size:20,className:"text-gray-600"})}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:[q.name," Charts"]}),(0,_.jsx)("p",{className:"text-gray-600",children:"Portfolio performance and allocation analysis"})]})]}),(0,_.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,_.jsxs)("button",{onClick:J,className:"flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,_.jsx)(j.A,{size:16}),(0,_.jsx)("span",{children:"Refresh"})]}),(0,_.jsxs)("button",{className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,_.jsx)(y.A,{size:16}),(0,_.jsx)("span",{children:"Export"})]})]})]})})}),(0,_.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,_.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm mb-6",children:[(0,_.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trade Status"}),(0,_.jsxs)("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[(0,_.jsx)("button",{onClick:()=>L("closed"),className:"flex-1 px-4 py-2 text-sm font-medium transition-colors ".concat("closed"===P?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"Closed Trades"}),(0,_.jsx)("button",{onClick:()=>L("all"),className:"flex-1 px-4 py-2 text-sm font-medium transition-colors ".concat("all"===P?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"All"})]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asset Type"}),(0,_.jsx)("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:["stocks","options","combined"].map((e=>(0,_.jsx)("button",{onClick:()=>z(e),className:"flex-1 px-3 py-2 text-sm font-medium transition-colors ".concat(F===e?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),(0,_.jsxs)("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[["daily","weekly","monthly","all"].map((e=>(0,_.jsx)("button",{onClick:()=>K(e),className:"flex-1 px-2 py-2 text-xs font-medium transition-colors ".concat(T===e?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))),(0,_.jsx)("button",{onClick:()=>B(!$),className:"flex items-center justify-center px-3 py-2 text-xs font-medium transition-colors ".concat("custom"===T?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:(0,_.jsx)(f.A,{size:14})})]})]})]}),$&&(0,_.jsxs)("div",{className:"mt-4 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[(0,_.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,_.jsx)("input",{type:"date",value:D.start,onChange:e=>O((t=>(0,a.A)((0,a.A)({},t),{},{start:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,_.jsx)("input",{type:"date",value:D.end,onChange:e=>O((t=>(0,a.A)((0,a.A)({},t),{},{end:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,_.jsx)("button",{onClick:()=>{K("custom"),B(!1)},className:"mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Apply Custom Range"})]})]}),H&&(0,_.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,_.jsx)("p",{className:"text-red-700",children:H})}),(0,_.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm mb-6",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"P&L Performance"}),(0,_.jsxs)("p",{className:"text-gray-600",children:["closed"===P?"Closed trades only":"All positions"," \u2022","combined"===F?" Stocks + Options":" ".concat(F.charAt(0).toUpperCase()+F.slice(1)," only")]})]}),(0,_.jsx)("div",{className:"flex items-center space-x-4",children:"combined"===F?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,_.jsx)("div",{className:"w-4 h-4 bg-green-500 rounded"}),(0,_.jsx)("span",{className:"text-sm text-gray-600",children:"Stocks"})]}),(0,_.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,_.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded"}),(0,_.jsx)("span",{className:"text-sm text-gray-600",children:"Options"})]}),(0,_.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,_.jsx)("div",{className:"w-4 h-4 bg-orange-500 rounded"}),(0,_.jsx)("span",{className:"text-sm text-gray-600",children:"Combined"})]})]}):(0,_.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,_.jsx)("div",{className:"w-4 h-4 rounded",style:{backgroundColor:Y[F]}}),(0,_.jsxs)("span",{className:"text-sm text-gray-600",children:[F.charAt(0).toUpperCase()+F.slice(1)," P&L"]})]})})]}),(0,_.jsx)("div",{className:"h-96",children:(0,_.jsx)(i.u,{width:"100%",height:"100%",children:(0,_.jsxs)(n.b,{data:ee,children:[(0,_.jsx)(r.d,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,_.jsx)(c.W,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#6B7280"}}),(0,_.jsx)(d.h,{axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#6B7280"},tickFormatter:e=>"$".concat(e.toFixed(0))}),(0,_.jsx)(x.m,{content:(0,_.jsx)(se,{})}),"combined"===F?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(m.N,{type:"monotone",dataKey:"stocks_pnl",stroke:Y.stocks,strokeWidth:2,dot:!1,name:"Stocks P&L"}),(0,_.jsx)(m.N,{type:"monotone",dataKey:"options_pnl",stroke:Y.options,strokeWidth:2,dot:!1,name:"Options P&L"}),(0,_.jsx)(m.N,{type:"monotone",dataKey:"combined_pnl",stroke:Y.combined,strokeWidth:3,dot:!1,name:"Combined P&L"})]}):(0,_.jsx)(m.N,{type:"monotone",dataKey:"pnl",stroke:Y[F],strokeWidth:3,dot:!1,name:"".concat(F.charAt(0).toUpperCase()+F.slice(1)," P&L")})]})})})]}),(0,_.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,_.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Portfolio Allocation"}),(0,_.jsx)("p",{className:"text-gray-600",children:"Active positions distribution"})]}),(0,_.jsx)(N.A,{size:20,className:"text-gray-400"})]}),(0,_.jsx)("div",{className:"h-64",children:(0,_.jsx)(i.u,{width:"100%",height:"100%",children:(0,_.jsxs)(h.r,{children:[(0,_.jsx)(u.F,{data:te,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:e=>{let{name:t,value:s}=e;return"".concat(t,": $").concat((s/1e3).toFixed(1),"k")},children:te.map(((e,t)=>(0,_.jsx)(p.f,{fill:"stocks"===e.type?Y.stocks:Y.options},"cell-".concat(t))))}),(0,_.jsx)(x.m,{formatter:e=>["$".concat(e.toLocaleString()),"Value"]})]})})})]}),(0,_.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Risk vs Return"}),(0,_.jsx)("p",{className:"text-gray-600",children:"Position analysis"})]}),(0,_.jsx)(k.A,{size:20,className:"text-gray-400"})]}),(0,_.jsx)("div",{className:"h-64",children:(0,_.jsx)(i.u,{width:"100%",height:"100%",children:(0,_.jsxs)(g.t,{data:te,children:[(0,_.jsx)(r.d,{strokeDasharray:"3 3"}),(0,_.jsx)(c.W,{dataKey:"count",name:"Position Size",tick:{fontSize:12,fill:"#6B7280"}}),(0,_.jsx)(d.h,{dataKey:"value",name:"Value",tick:{fontSize:12,fill:"#6B7280"},tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,_.jsx)(x.m,{formatter:(e,t)=>["Value"===t?"$".concat(e.toLocaleString()):e,t],labelFormatter:e=>"Position: ".concat(e)}),(0,_.jsx)(b.X,{dataKey:"value",fill:Y.combined})]})})})]})]}),(0,_.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,_.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,_.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Portfolio Summary"})}),(0,_.jsx)("div",{className:"p-6",children:(0,_.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,_.jsxs)("div",{className:"text-center",children:[(0,_.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:["$",(null===M||void 0===M||null===(e=M.total_value)||void 0===e?void 0:e.toLocaleString())||"0.00"]}),(0,_.jsx)("div",{className:"text-sm text-gray-600",children:"Total Portfolio Value"}),(0,_.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Cash excluded from charts: $",(null===M||void 0===M||null===(t=M.cash_balance)||void 0===t?void 0:t.toLocaleString())||"0.00"]})]}),(0,_.jsxs)("div",{className:"text-center",children:[(0,_.jsxs)("div",{className:"text-2xl font-bold ".concat(((null===M||void 0===M?void 0:M.total_pnl)||0)>=0?"text-green-600":"text-red-600"),children:[((null===M||void 0===M?void 0:M.total_pnl)||0)>=0?"+":"","$",(null===M||void 0===M||null===(s=M.total_pnl)||void 0===s?void 0:s.toFixed(2))||"0.00"]}),(0,_.jsx)("div",{className:"text-sm text-gray-600",children:"Total P&L"}),(0,_.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"closed"===P?"Closed positions only":"All positions"})]}),(0,_.jsxs)("div",{className:"text-center",children:[(0,_.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:te.length}),(0,_.jsx)("div",{className:"text-sm text-gray-600",children:"Active Positions"}),(0,_.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"combined"===F?"Stocks + Options":F})]})]})})]})]})]})}}}]);
//# sourceMappingURL=336.27b42c98.chunk.js.map