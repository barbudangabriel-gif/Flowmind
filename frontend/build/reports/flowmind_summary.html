<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rezumat FlowMind Analytics - Iunie 2025</title>
  <style>
    :root {
      --bg: #0b1220;
      --card: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #60a5fa;
      --border: #1f2937;
      --ok: #34d399;
      --warn: #f59e0b;
      --bad: #ef4444;
    }
    @media print {
      .no-print { display: none !important; }
      body { background: #fff; }
      .container { box-shadow: none; }
    }
    html, body { margin: 0; padding: 0; font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: var(--text); background: var(--bg); }
    .container { max-width: 1024px; margin: 24px auto; background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 28px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
    h1 { margin: 0 0 8px; font-size: 24px; }
    h2 { margin: 24px 0 8px; font-size: 18px; border-bottom: 1px solid var(--border); padding-bottom: 6px; }
    h3 { margin: 18px 0 6px; font-size: 16px; color: var(--accent); }
    p, li { line-height: 1.6; color: var(--text); }
    .muted { color: var(--muted); }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .card { background: #0f1626; border: 1px solid var(--border); border-radius: 12px; padding: 14px; }
    ul { margin: 8px 0 8px 18px; }
    .tags { display: flex; flex-wrap: wrap; gap: 8px; }
    .tag { font-size: 12px; padding: 4px 8px; border: 1px solid var(--border); border-radius: 999px; color: var(--muted); }
    .ok { color: var(--ok); }
    .warn { color: var(--warn); }
    .bad { color: var(--bad); }
    .header { display: flex; align-items: center; justify-content: space-between; gap: 16px; margin-bottom: 8px; }
    .btn { background: var(--accent); color: #0b1220; padding: 8px 14px; border-radius: 8px; border: 0; cursor: pointer; font-weight: 600; }
    .small { font-size: 12px; }
    .spacer { height: 10px; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1>Rezumat proiect FlowMind Analytics</h1>
        <div class="muted small">Stare la: Iunie 2025</div>
      </div>
      <div class="no-print">
        <button class="btn" onclick="window.print()">Printează / Export PDF</button>
      </div>
    </div>

    <h2>Arhitectură & Tehnologie</h2>
    <div class="grid">
      <div class="card">
        <h3>Frontend</h3>
        <ul>
          <li>React (Router, Tailwind)</li>
          <li>Recharts (donut Win/Loss), Plotly (grafic P/L)</li>
          <li>Integrare backend via <span class="mono">REACT_APP_BACKEND_URL</span></li>
        </ul>
      </div>
      <div class="card">
        <h3>Backend & DB</h3>
        <ul>
          <li>FastAPI (Python), httpx/asyncio</li>
          <li>MongoDB (snapshot-uri monitor)</li>
          <li>Acces DB via <span class="mono">MONGO_URL</span> (env)</li>
        </ul>
      </div>
    </div>

    <h2>Reguli de mediu (respectate)</h2>
    <ul>
      <li>Frontend → Backend: doar prin <span class="mono">REACT_APP_BACKEND_URL</span>, rute backend cu prefix <span class="mono">/api</span></li>
      <li>Backend → Mongo: <span class="mono">os.environ.get("MONGO_URL")</span></li>
      <li>Binding backend: <span class="mono">0.0.0.0:8001</span>; fără hardcodări .env</li>
    </ul>

    <h2>Backend – Puts Options Selling</h2>
    <h3>Compute</h3>
    <ul>
      <li><span class="mono">POST /api/options/selling/compute</span> – moduri: equal | greedy | both</li>
      <li>Config: Δ/DTE, IV Rank/VIX, praguri roll, <span class="mono">capital_base</span>, dynamic_risk</li>
      <li>Sub-strategie Covered Calls: <span class="mono">cc_config</span> + <span class="mono">cc_inputs</span></li>
    </ul>
    <h3>Monitor</h3>
    <ul>
      <li>Loop async în memorie (default 15s) cu snapshot în Mongo</li>
      <li>Rute: <span class="mono">/monitor/start</span>, <span class="mono">/monitor/status</span>, <span class="mono">/monitor/stop</span></li>
      <li>Snapshot: <span class="mono">ts</span>, summary, signals, diffs, cycles, config</li>
    </ul>
    <h3>Analysis</h3>
    <ul>
      <li><span class="mono">GET /api/options/selling/analysis</span> – simulează lifecycle din <span class="mono">diffs.added</span></li>
      <li>Returnează: KPI, metrics, <span class="mono">closed_trades</span>, <span class="mono">series</span> (cumulative P/L)</li>
      <li>Fix vizibilitate: <span class="mono">xIndex</span> în serie pentru axă Index (evită suprapuneri timestamp)</li>
    </ul>

    <h2>Frontend – Options Selling</h2>
    <h3>Rute</h3>
    <ul>
      <li><span class="mono">/options/selling</span> – modul principal</li>
      <li><span class="mono">/options</span> – builder strategii (existent)</li>
    </ul>
    <h3>Tab-uri & funcții</h3>
    <ul>
      <li><b>Candidates</b>: config motor, watchlist, CC (thresholds + cc_inputs JSON)</li>
      <li><b>Trade List</b>: tabel + grupare, Monitor panel (Start/Stop/Status), diffs Added/Removed/Changed, rezumat CC</li>
      <li><b>Live Positions</b> (TS): cont/poziții/opțiuni, grupare, expand/collapse</li>
      <li><b>Analyze</b>: filtre, KPI/metrics, donut Win/Loss (Recharts), grafic Closed P/L (Plotly)
        <ul>
          <li>Axă X implicit: Index (control ascuns, dots/stroke mărite)</li>
          <li>Export: JSON/CSV pentru <span class="mono">closed_trades</span></li>
          <li>Tema „Envato – Data Analyzer” păstrată</li>
        </ul>
      </li>
    </ul>

    <h2>Sidebar – structură & UX</h2>
    <div class="grid">
      <div class="card">
        <h3>Structură actuală</h3>
        <ul>
          <li>Home: Stock Search, Market News (Icon Preview – temporar)</li>
          <li>Portfolios: All Portfolios, TS MAIN, Create Portfolio</li>
          <li>TradeStation: Authentication, Account Balance</li>
          <li>Options Module: Strategy Builder, Puts Options Selling</li>
          <li>Investment Scoring: Scoring, Scanner</li>
          <li>Unusual Whales: Options Flow, Dark Pool, Congressional, Strategies</li>
          <li>Auto Options Trading: Engine, History, Performance</li>
        </ul>
      </div>
      <div class="card">
        <h3>Detalii UI</h3>
        <ul>
          <li>Chevron (collapse) uniform; iconuri headere în stânga conform selecției</li>
          <li>Rail vertical discret (border-l) pe toată înălțimea</li>
          <li>Logo revenit la dimensiuni inițiale (fără card)</li>
        </ul>
      </div>
    </div>

    <h2>Portfolios – rute & pagini</h2>
    <ul>
      <li><span class="mono">/portfolios</span> → AllPortfolios (listă + carduri)</li>
      <li><span class="mono">/portfolios/create</span> → CreatePortfolio</li>
      <li><span class="mono">/portfolios/:portfolioId</span> → IndividualPortfolio</li>
      <li><span class="mono">/portfolios/:portfolioId/charts</span> → PortfolioCharts</li>
      <li>Shortcut: <span class="mono">/portfolios/tradestation-main</span> → IndividualPortfolio (TS MAIN)</li>
    </ul>

    <h2>TradeStation – status</h2>
    <ul>
      <li>OAuth2 + PKCE + refresh – implementat (TS Main)</li>
      <li>Meniu TS simplificat: Authentication + Account Balance</li>
    </ul>


    <h2>Unusual Whales – Integrare</h2>
    <ul>
      <li>Module UI: <b>Options Flow</b>, <b>Dark Pool</b>, <b>Congressional Trades</b> (active în meniu)</li>
      <li>Backend: rute prefixate <span class="mono">/api/unusualwhales/…</span>, cheie în env (ex.: <span class="mono">UNUSUAL_WHALES_API_KEY</span>)</li>
      <li>Options Flow: filtre (premium minim, volum/OI ratio, limită rezultate), auto-refresh, “Last update” și sentiment/size badges</li>
      <li>Dark Pool: filtre volum, procent dark, sumarizări și indicatori de semnificație</li>
      <li>Congressional Trades: filtre pe perioadă (zile), sumă minimă, partid, tip tranzacție; top reprezentanți/sectoare</li>
      <li>Respectă regulile de mediu: fără hardcodări; toate rutele backend cu prefix <span class="mono">/api</span></li>
    </ul>

    <h2>Ce s-a fixat azi</h2>
    <ul>
      <li>Grafic Analyze vizibil (Plotly), axă Index, exporturi, control X-axis ascuns</li>
      <li>Sidebar: structură curățată, iconuri stânga, rail, chevron/collapse aliniate, TS MAIN sub Portfolios</li>
      <li>Rute Portfolios restabilite (inclusiv TS MAIN)</li>
    </ul>

    <h2>Next (opțiuni propuse)</h2>
    <ul>
      <li>A) Export JSON/CSV pentru “Trade List” (tab Trade List)</li>
      <li>B) Upload CSV pentru “Candidates” (backend parser + UI)</li>
      <li>C) Filtre + totaluri în “Live Positions” (doar PUT-uri, short/long, sume pe tip)</li>
      <li>Streaming Market Data (Options) + builder P/L + greci (Faza 2)</li>
      <li>Eliminare “Icon Preview (temp)” după confirmare</li>
    </ul>

    <div class="spacer"></div>
    <div class="muted small">Document print-ready • FlowMind Analytics • Iunie 2025</div>
  </div>
</body>
</html>
